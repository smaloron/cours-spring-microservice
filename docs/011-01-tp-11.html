<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-27T21:24:57.145708"><title>TP 11 : Monitoring de l'Architecture avec Prometheus et Grafana | Spring Micro Services</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs Pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction-construire-le-cockpit","level":0,"title":"Introduction : Construire le cockpit","anchor":"#introduction-construire-le-cockpit"},{"id":"tape-1-ajout-de-prometheus-et-grafana-docker-compose","level":0,"title":"Étape 1 : Ajout de Prometheus et Grafana à Docker Compose","anchor":"#tape-1-ajout-de-prometheus-et-grafana-docker-compose"},{"id":"tape-2-configuration-de-prometheus","level":0,"title":"Étape 2 : Configuration de Prometheus","anchor":"#tape-2-configuration-de-prometheus"},{"id":"tape-3-configurer-les-microservices-pour-exposer-les-m-triques","level":0,"title":"Étape 3 : Configurer les Microservices pour exposer les Métriques","anchor":"#tape-3-configurer-les-microservices-pour-exposer-les-m-triques"},{"id":"tape-4-lancement-et-exploration","level":0,"title":"Étape 4 : Lancement et Exploration","anchor":"#tape-4-lancement-et-exploration"},{"id":"exercice-14-cr-er-un-panneau-personnalis","level":0,"title":"Exercice 14 : Créer un panneau personnalisé","anchor":"#exercice-14-cr-er-un-panneau-personnalis"},{"id":"auto-valuation","level":0,"title":"Auto-évaluation","anchor":"#auto-valuation"},{"id":"conclusion","level":0,"title":"Conclusion","anchor":"#conclusion"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="TP 11 : Monitoring de l'Architecture avec Prometheus et Grafana | Spring Micro Services"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Spring Micro Services Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/011-01-tp-11.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="TP 11 : Monitoring de l'Architecture avec Prometheus et Grafana | Spring Micro Services"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/011-01-tp-11.html#webpage",
    "url": "writerside-documentation/011-01-tp-11.html",
    "name": "TP 11 : Monitoring de l'Architecture avec Prometheus et Grafana | Spring Micro Services",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Spring Micro Services Help"
}</script><!-- End Schema.org --></head><body data-id="011-01-TP-11" data-main-title="TP 11 : Monitoring de l'Architecture avec Prometheus et Grafana" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="011-00-monitoring.md|Module 11 : Monitoring et Métriques (Prometheus &amp; Grafana) - Prendre le pouls du système"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Spring Micro Services  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="011-01-TP-11" id="011-01-TP-11.md">TP 11 : Monitoring de l'Architecture avec Prometheus et Grafana</h1><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs P&eacute;dagogiques</h2><p id="-xm8n4d_12">&Agrave; la fin de ce TP, vous serez capable de :</p><ul class="list _bullet" id="-xm8n4d_13"><li class="list__item" id="-xm8n4d_14"><p id="-xm8n4d_20">Ajouter Prometheus et Grafana &agrave; votre <code class="code" id="-xm8n4d_21">docker-compose.yml</code>.</p></li><li class="list__item" id="-xm8n4d_15"><p id="-xm8n4d_22">Configurer Prometheus pour qu'il d&eacute;couvre et &quot;scrape&quot; (collecte) les m&eacute;triques de vos microservices.</p></li><li class="list__item" id="-xm8n4d_16"><p id="-xm8n4d_23">Ajouter les d&eacute;pendances Actuator et Micrometer &agrave; vos services pour exposer les m&eacute;triques au format Prometheus.</p></li><li class="list__item" id="-xm8n4d_17"><p id="-xm8n4d_24">Configurer Grafana pour utiliser Prometheus comme source de donn&eacute;es.</p></li><li class="list__item" id="-xm8n4d_18"><p id="-xm8n4d_25">Importer un tableau de bord communautaire pour visualiser les m&eacute;triques de la JVM.</p></li><li class="list__item" id="-xm8n4d_19"><p id="-xm8n4d_26">Cr&eacute;er un panneau personnalis&eacute; simple dans Grafana.</p></li></ul></section><section class="chapter"><h2 id="introduction-construire-le-cockpit" data-toc="introduction-construire-le-cockpit">Introduction : Construire le cockpit</h2><p id="-xm8n4d_27">Nous avons la th&eacute;orie, il est temps de construire notre cockpit. Nous allons ajouter deux nouveaux services &agrave; notre <code class="code" id="-xm8n4d_30">docker-compose.yml</code>:</p><ol class="list _decimal" id="-xm8n4d_28" type="1"><li class="list__item" id="-xm8n4d_31"><p id="-xm8n4d_33"><span class="control" id="-xm8n4d_34">Prometheus :</span> Notre enregistreur de vol, qui va constamment interroger nos services pour conna&icirc;tre leur &eacute;tat.</p></li><li class="list__item" id="-xm8n4d_32"><p id="-xm8n4d_35"><span class="control" id="-xm8n4d_36">Grafana :</span> L'&eacute;cran du cockpit, sur lequel nous afficherons les cadrans et les jauges.</p></li></ol><p id="-xm8n4d_29">Ensuite, nous allons &eacute;quiper chacun de nos services d'une &quot;sonde&quot; (Actuator + Micrometer) pour qu'ils puissent communiquer leurs m&eacute;triques &agrave; Prometheus. &Agrave; la fin, nous aurons un tableau de bord dynamique affichant en temps r&eacute;el la sant&eacute; de nos applications.</p></section><section class="chapter"><h2 id="tape-1-ajout-de-prometheus-et-grafana-docker-compose" data-toc="tape-1-ajout-de-prometheus-et-grafana-docker-compose">&Eacute;tape 1 : Ajout de Prometheus et Grafana &agrave; Docker Compose</h2><section class="procedure-steps" id="-xm8n4d_37"><p id="-xm8n4d_38">Ouvrez votre fichier <code class="code" id="-xm8n4d_40">docker-compose.yml</code>. Nous ajoutons deux nouveaux services.</p><div class="code-block" data-lang="yaml">
# Dans docker-compose.yml
services:
  # ... (tous vos services existants)

  # 10. Prometheus : Le serveur de métriques
  prometheus:
    image: prom/prometheus:v2.51.1 # Utilisez une version récente
    ports:
      - &quot;9091:9090&quot; # On mappe le port de Prometheus sur 9091 pour éviter les conflits
    volumes:
      # On monte notre futur fichier de configuration Prometheus
      - ./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml
    command: --config.file=/etc/prometheus/prometheus.yml

  # 11. Grafana : Le serveur de dashboards
  grafana:
    image: grafana/grafana:10.4.1
    ports:
      - &quot;3000:3000&quot; # Port standard de l'interface web de Grafana
    volumes:
      # On monte un volume pour persister les dashboards et configurations de Grafana
      - grafana_data:/var/lib/grafana
    depends_on:
      - prometheus

# ...
volumes:
  # ... (es_data, etc.)
  grafana_data:
</div><ol class="list _decimal"></ol></section></section><section class="chapter"><h2 id="tape-2-configuration-de-prometheus" data-toc="tape-2-configuration-de-prometheus">&Eacute;tape 2 : Configuration de Prometheus</h2><p id="-xm8n4d_41">Prometheus a besoin d'un fichier de configuration pour savoir quelles &quot;cibles&quot; (targets) il doit scraper.</p><section class="procedure-steps" id="-xm8n4d_42"><p id="-xm8n4d_43">1. &Agrave; la racine de votre projet <code class="code" id="-xm8n4d_47">gestbook-microservices</code>, cr&eacute;ez un nouveau dossier <code class="code" id="-xm8n4d_48">prometheus</code>.</p><p id="-xm8n4d_44">2. Dans ce dossier, cr&eacute;ez un fichier <code class="code" id="-xm8n4d_49">prometheus.yml</code>.</p><div class="code-block" data-lang="yaml">
# prometheus.yml

# Configuration globale
global:
  scrape_interval: 15s # A quelle fréquence scraper les cibles

# Configuration des jobs de scraping
scrape_configs:
  # Job pour scraper nos microservices Spring Boot
  - job_name: 'spring-micrometer'
    metrics_path: '/actuator/prometheus' # Le chemin de l'endpoint des métriques
    # Comment trouver les cibles ? On utilise la découverte de fichiers.
    # On pourrait aussi utiliser la découverte via Eureka avec un adaptateur.
    # Pour ce TP, on liste les services manuellement.
    static_configs:
      - targets:
          - 'product-service:8081'
          - 'order-service:8082'
          - 'api-gateway:8080'
        # On ne monitore pas config-server et eureka-server pour simplifier
</div><aside class="prompt" data-type="warning" data-title="" id="-xm8n4d_46"><p><b id="-xm8n4d_50">D&eacute;couverte de services avec Prometheus</b></p><p id="-xm8n4d_51">Lister manuellement les cibles fonctionne pour un TP, mais ce n'est pas dynamique. En production, Prometheus peut s'int&eacute;grer avec des syst&egrave;mes de d&eacute;couverte comme Eureka, Consul ou Kubernetes pour trouver automatiquement les nouvelles instances de services &agrave; scraper.</p></aside><ol class="list _decimal"></ol></section></section><section class="chapter"><h2 id="tape-3-configurer-les-microservices-pour-exposer-les-m-triques" data-toc="tape-3-configurer-les-microservices-pour-exposer-les-m-triques">&Eacute;tape 3 : Configurer les Microservices pour exposer les M&eacute;triques</h2><p id="-xm8n4d_52">Nous devons maintenant &quot;instrumenter&quot; nos services pour qu'ils exposent l'endpoint <code class="code" id="-xm8n4d_54">/actuator/prometheus</code>.</p><section class="procedure-steps" id="-xm8n4d_53"><p id="-xm8n4d_55"><b id="-xm8n4d_67">Pour chaque microservice &agrave; monitorer</b> (`product-service`, `order-service`, `api-gateway`) :</p><p id="-xm8n4d_56">1. <b id="-xm8n4d_68">Ajouter les d&eacute;pendances dans `pom.xml`</b></p><p id="-xm8n4d_57">Si vous ne l'avez pas d&eacute;j&agrave; fait, ajoutez Actuator. Puis ajoutez le &quot;registry&quot; Micrometer pour Prometheus.</p><p> ```xml </p><p> ``` </p><p id="-xm8n4d_60">2. <b id="-xm8n4d_74">Exposer l'endpoint dans la configuration</b></p><p id="-xm8n4d_61">Nous allons modifier notre configuration centralis&eacute;e. Ouvrez le fichier <code class="code" id="-xm8n4d_75">application.properties</code> dans votre d&eacute;p&ocirc;t <code class="code" id="-xm8n4d_76">gestbook-config-repo</code>.</p><p id="-xm8n4d_62">Modifiez la ligne `management.endpoints.web.exposure.include` pour y ajouter `prometheus`.</p><div class="code-block" data-lang="properties">
# Dans gestbook-config-repo/application.properties
# On expose health, info, configprops (déjà là) et maintenant prometheus
management.endpoints.web.exposure.include=health,info,configprops,prometheus
</div><p id="-xm8n4d_64">Commitez ce changement dans le d&eacute;p&ocirc;t Git.</p><p id="-xm8n4d_65">3. <b id="-xm8n4d_77">Reconstruire les images Docker</b></p><p id="-xm8n4d_66">Apr&egrave;s avoir ajout&eacute; les d&eacute;pendances &agrave; tous vos services, reconstruisez leurs images Docker (`mvn clean package` et `docker build ...`).</p><ol class="list _decimal"></ol></section></section><section class="chapter"><h2 id="tape-4-lancement-et-exploration" data-toc="tape-4-lancement-et-exploration">&Eacute;tape 4 : Lancement et Exploration</h2><section class="procedure-steps" id="-xm8n4d_78"><p id="-xm8n4d_80">1. Lancez tout l'&eacute;cosyst&egrave;me avec <code class="code" id="-xm8n4d_88">docker-compose up</code>.</p><p id="-xm8n4d_81">2. <b id="-xm8n4d_89">V&eacute;rifier Prometheus :</b></p><ul class="list _bullet" id="-xm8n4d_82"><li class="list__item" id="-xm8n4d_90"><p>Ouvrez Prometheus dans votre navigateur : <a href="http://localhost:9091/" id="-xm8n4d_93" data-external="true" rel="noopener noreferrer" target="_blank">http://localhost:9091/</a>.</p></li><li class="list__item" id="-xm8n4d_91"><p>Allez dans le menu &quot;Status&quot; &gt; &quot;Targets&quot;.</p></li><li class="list__item" id="-xm8n4d_92"><p>Vous devriez voir vos trois services list&eacute;s (`product-service`, `order-service`, `api-gateway`). Leur &eacute;tat doit &ecirc;tre &quot;UP&quot; (en vert). Cela signifie que Prometheus a r&eacute;ussi &agrave; les contacter et &agrave; scraper leurs m&eacute;triques.</p></li></ul><p id="-xm8n4d_83">3. <b id="-xm8n4d_94">Configurer Grafana :</b></p><ul class="list _bullet" id="-xm8n4d_84"><li class="list__item" id="-xm8n4d_95"><p>Ouvrez Grafana : <a href="http://localhost:3000/" id="-xm8n4d_98" data-external="true" rel="noopener noreferrer" target="_blank">http://localhost:3000/</a>.</p></li><li class="list__item" id="-xm8n4d_96"><p>Le login/mot de passe par d&eacute;faut est <code class="code" id="-xm8n4d_99">admin</code>/<code class="code" id="-xm8n4d_100">admin</code>. Grafana vous demandera de changer le mot de passe.</p></li><li class="list__item" id="-xm8n4d_97"><p><b id="-xm8n4d_101">Ajouter la source de donn&eacute;es :</b></p><ul class="list _bullet" id="-xm8n4d_102"><li class="list__item" id="-xm8n4d_103"><p>Allez dans le menu &quot;Connections&quot; (ou l'ic&ocirc;ne de roue dent&eacute;e &gt; Data Sources).</p></li><li class="list__item" id="-xm8n4d_104"><p>Cliquez sur &quot;Add new data source&quot;.</p></li><li class="list__item" id="-xm8n4d_105"><p>Choisissez &quot;Prometheus&quot;.</p></li><li class="list__item" id="-xm8n4d_106"><p>Dans le champ &quot;Prometheus server URL&quot;, entrez <code class="code" id="-xm8n4d_108">http://prometheus:9090</code>. C'est l'adresse de Prometheus &agrave; l'int&eacute;rieur du r&eacute;seau Docker.</p></li><li class="list__item" id="-xm8n4d_107"><p>Cliquez sur &quot;Save &amp; test&quot;. Vous devriez voir un message de succ&egrave;s.</p></li></ul></li></ul><p id="-xm8n4d_85">4. <b id="-xm8n4d_109">Importer un Dashboard Communautaire :</b></p><ul class="list _bullet" id="-xm8n4d_86"><li class="list__item" id="-xm8n4d_110"><p>Allez dans le menu &quot;Dashboards&quot;.</p></li><li class="list__item" id="-xm8n4d_111"><p>Cliquez sur &quot;New&quot; &gt; &quot;Import&quot;.</p></li><li class="list__item" id="-xm8n4d_112"><p>Grafana a une immense communaut&eacute; qui partage des dashboards. Un des plus populaires pour les applications Spring Boot est le <b id="-xm8n4d_117">12900</b>.</p></li><li class="list__item" id="-xm8n4d_113"><p>Dans le champ &quot;Import via grafana.com&quot;, collez l'ID <code class="code" id="-xm8n4d_118">12900</code> et cliquez sur &quot;Load&quot;.</p></li><li class="list__item" id="-xm8n4d_114"><p>Dans la page suivante, s&eacute;lectionnez votre source de donn&eacute;es &quot;Prometheus&quot; dans la liste d&eacute;roulante.</p></li><li class="list__item" id="-xm8n4d_115"><p>Cliquez sur &quot;Import&quot;.</p></li><li class="list__item" id="-xm8n4d_116"><p>Magie ! Vous avez maintenant un tableau de bord complet qui affiche des m&eacute;triques d&eacute;taill&eacute;es sur la JVM, le CPU, Tomcat, etc. pour chacun de vos services. Vous pouvez s&eacute;lectionner le service &agrave; visualiser en haut.</p></li></ul><figure id="-xm8n4d_87"><img alt="Dashboard Grafana import&eacute;" src="${primarySource}" title="Dashboard Grafana import&eacute;"></figure><ol class="list _decimal"></ol></section></section><section class="chapter"><h2 id="exercice-14-cr-er-un-panneau-personnalis" data-toc="exercice-14-cr-er-un-panneau-personnalis">Exercice 14 : Cr&eacute;er un panneau personnalis&eacute;</h2><p id="-xm8n4d_119"><span class="control" id="-xm8n4d_123">Contexte :</span> Le dashboard import&eacute; est excellent pour les m&eacute;triques techniques. Cr&eacute;ons maintenant un panneau simple pour une m&eacute;trique qui nous int&eacute;resse : le nombre total de requ&ecirc;tes HTTP qui se sont termin&eacute;es avec un code d'erreur (4xx ou 5xx).</p><p id="-xm8n4d_120"><span class="control" id="-xm8n4d_124">Votre mission :</span></p><ol class="list _decimal" id="-xm8n4d_121" type="1"><li class="list__item" id="-xm8n4d_125"><p id="-xm8n4d_134">Dans Grafana, cr&eacute;ez un nouveau tableau de bord (&quot;New&quot; &gt; &quot;New Dashboard&quot;).</p></li><li class="list__item" id="-xm8n4d_126"><p id="-xm8n4d_135">Cliquez sur &quot;Add visualization&quot;.</p></li><li class="list__item" id="-xm8n4d_127"><p id="-xm8n4d_136">Assurez-vous que votre source de donn&eacute;es &quot;Prometheus&quot; est s&eacute;lectionn&eacute;e.</p></li><li class="list__item" id="-xm8n4d_128"><p id="-xm8n4d_137">Passez en mode &quot;Code&quot; pour l'&eacute;diteur de requ&ecirc;te.</p></li><li class="list__item" id="-xm8n4d_129"><p id="-xm8n4d_138">La m&eacute;trique qui nous int&eacute;resse est <code class="code" id="-xm8n4d_139">http_server_requests_seconds_count</code>. Nous voulons la somme de toutes les requ&ecirc;tes dont le statut n'est pas un succ&egrave;s. La requ&ecirc;te PromQL (Prometheus Query Language) est : <code class="code" id="-xm8n4d_140">sum(http_server_requests_seconds_count{status!~&quot;2..&quot;})</code></p></li><li class="list__item" id="-xm8n4d_130"><p id="-xm8n4d_141">Dans le panneau de droite, choisissez un type de visualisation, par exemple &quot;Stat&quot;.</p></li><li class="list__item" id="-xm8n4d_131"><p id="-xm8n4d_142">Donnez un titre &agrave; votre panneau, par exemple &quot;Total HTTP Errors&quot;.</p></li><li class="list__item" id="-xm8n4d_132"><p id="-xm8n4d_143">Cliquez sur &quot;Apply&quot; pour ajouter le panneau au tableau de bord.</p></li><li class="list__item" id="-xm8n4d_133"><p id="-xm8n4d_144">G&eacute;n&eacute;rez une erreur (par exemple, en appelant une URL qui n'existe pas sur la gateway) et observez le chiffre sur votre panneau augmenter.</p></li></ol><section class="chapter"><div class="collapse"><div class="collapse__title"><h3 id="correction-exercice-14" data-toc="correction-exercice-14">Correction exercice 14</h3></div><div class="collapse__content"><p id="-xm8n4d_145">En suivant les &eacute;tapes, vous devriez obtenir un nouveau panneau sur votre dashboard qui affiche un chiffre.</p><ol class="list _decimal" id="-xm8n4d_146" type="1"><li class="list__item" id="-xm8n4d_148"><p id="-xm8n4d_155">Ouvrez un nouveau dashboard et cliquez sur &quot;Add visualization&quot;.</p></li><li class="list__item" id="-xm8n4d_149"><p id="-xm8n4d_156">S&eacute;lectionnez la source de donn&eacute;es Prometheus.</p></li><li class="list__item" id="-xm8n4d_150"><p id="-xm8n4d_157">Entrez la requ&ecirc;te PromQL : <code class="code" id="-xm8n4d_159">sum(http_server_requests_seconds_count{status!~&quot;2..&quot;})</code>.</p><ul class="list _bullet" id="-xm8n4d_158"><li class="list__item" id="-xm8n4d_160"><p id="-xm8n4d_163"><code class="code" id="-xm8n4d_164">http_server_requests_seconds_count</code> est le nom de la m&eacute;trique g&eacute;n&eacute;r&eacute;e par Micrometer.</p></li><li class="list__item" id="-xm8n4d_161"><p id="-xm8n4d_165"><code class="code" id="-xm8n4d_166">{status!~&quot;2..&quot;}</code> est un s&eacute;lecteur qui filtre les s&eacute;ries temporelles pour ne garder que celles dont le label <code class="code" id="-xm8n4d_167">status</code> ne correspond pas &agrave; l'expression r&eacute;guli&egrave;re <code class="code" id="-xm8n4d_168">2..</code> (c'est-&agrave;-dire, tous les codes qui ne sont pas des 2xx).</p></li><li class="list__item" id="-xm8n4d_162"><p id="-xm8n4d_169"><code class="code" id="-xm8n4d_170">sum(...)</code> agr&egrave;ge les r&eacute;sultats de tous les services en une seule valeur.</p></li></ul></li><li class="list__item" id="-xm8n4d_151"><p id="-xm8n4d_171">Dans les options du panneau &agrave; droite, sous &quot;Visualization&quot;, choisissez &quot;Stat&quot;.</p></li><li class="list__item" id="-xm8n4d_152"><p id="-xm8n4d_172">Sous &quot;Panel options&quot;, donnez un titre.</p></li><li class="list__item" id="-xm8n4d_153"><p id="-xm8n4d_173">Cliquez sur le bouton &quot;Apply&quot; en haut &agrave; droite.</p></li><li class="list__item" id="-xm8n4d_154"><p id="-xm8n4d_174">Pour tester, faites un appel &agrave; une URL invalide comme <code class="code" id="-xm8n4d_175">GET http://localhost:8080/nonexistent</code>. Vous recevrez une erreur 404. Rafra&icirc;chissez votre dashboard Grafana, et vous verrez le compteur du panneau &quot;Total HTTP Errors&quot; s'incr&eacute;menter.</p></li></ol></div></div></section></section><section class="chapter"><h2 id="auto-valuation" data-toc="auto-valuation">Auto-&eacute;valuation</h2><ol class="list _decimal" id="-xm8n4d_176" type="1"><li class="list__item" id="-xm8n4d_178"><p id="-xm8n4d_183"><span class="control" id="-xm8n4d_185">(QCM)</span> Quelle d&eacute;pendance Maven est n&eacute;cessaire pour qu'une application Spring Boot expose ses m&eacute;triques au format Prometheus ?</p><ul class="list _bullet" id="-xm8n4d_184"><li class="list__item" id="-xm8n4d_186"><p id="-xm8n4d_190">A) <code class="code" id="-xm8n4d_191">spring-boot-starter-actuator</code></p></li><li class="list__item" id="-xm8n4d_187"><p id="-xm8n4d_192">B) <code class="code" id="-xm8n4d_193">micrometer-core</code></p></li><li class="list__item" id="-xm8n4d_188"><p id="-xm8n4d_194">C) <code class="code" id="-xm8n4d_195">micrometer-registry-prometheus</code></p></li><li class="list__item" id="-xm8n4d_189"><p id="-xm8n4d_196">D) <code class="code" id="-xm8n4d_197">prometheus-client</code></p></li></ul></li><li class="list__item" id="-xm8n4d_179"><p id="-xm8n4d_198"><span class="control" id="-xm8n4d_199">(Question ouverte)</span> Dans la configuration de Grafana, pourquoi doit-on utiliser l'URL <code class="code" id="-xm8n4d_200">http://prometheus:9090</code> et non <code class="code" id="-xm8n4d_201">http://localhost:9091</code> pour la source de donn&eacute;es ?</p></li><li class="list__item" id="-xm8n4d_180"><p id="-xm8n4d_202"><span class="control" id="-xm8n4d_204">(QCM)</span> La &quot;fa&ccedil;ade de m&eacute;triques&quot; qui permet &agrave; une application Spring de s'int&eacute;grer avec de multiples syst&egrave;mes de monitoring s'appelle :</p><ul class="list _bullet" id="-xm8n4d_203"><li class="list__item" id="-xm8n4d_205"><p id="-xm8n4d_209">A) Actuator</p></li><li class="list__item" id="-xm8n4d_206"><p id="-xm8n4d_210">B) Grafana</p></li><li class="list__item" id="-xm8n4d_207"><p id="-xm8n4d_211">C) SLF4J</p></li><li class="list__item" id="-xm8n4d_208"><p id="-xm8n4d_212">D) Micrometer</p></li></ul></li><li class="list__item" id="-xm8n4d_181"><p id="-xm8n4d_213"><span class="control" id="-xm8n4d_214">(Question ouverte)</span> Qu'est-ce que le &quot;scraping&quot; dans le contexte de Prometheus ?</p></li><li class="list__item" id="-xm8n4d_182"><p id="-xm8n4d_215"><span class="control" id="-xm8n4d_217">(QCM)</span> Pour visualiser les m&eacute;triques de la JVM (utilisation de la m&eacute;moire, etc.) de vos microservices, quelle est la fa&ccedil;on la plus rapide de proc&eacute;der dans Grafana ?</p><ul class="list _bullet" id="-xm8n4d_216"><li class="list__item" id="-xm8n4d_218"><p id="-xm8n4d_222">A) Cr&eacute;er manuellement chaque graphique un par un.</p></li><li class="list__item" id="-xm8n4d_219"><p id="-xm8n4d_223">B) Importer un dashboard communautaire existant via son ID.</p></li><li class="list__item" id="-xm8n4d_220"><p id="-xm8n4d_224">C) &Eacute;crire un script pour g&eacute;n&eacute;rer le dashboard.</p></li><li class="list__item" id="-xm8n4d_221"><p id="-xm8n4d_225">D) On ne peut pas visualiser ces m&eacute;triques, seulement les m&eacute;triques m&eacute;tier.</p></li></ul></li></ol></section><section class="chapter"><h2 id="conclusion" data-toc="conclusion">Conclusion</h2><p id="-xm8n4d_226">Votre cockpit est maintenant fonctionnel ! Vous avez compl&eacute;t&eacute; le triptyque de l'observabilit&eacute; : <span class="control" id="-xm8n4d_230">Logs, Traces et M&eacute;triques</span>. Gr&acirc;ce &agrave; <span class="control" id="-xm8n4d_231">Prometheus</span> et <span class="control" id="-xm8n4d_232">Grafana</span>, vous n'&ecirc;tes plus aveugle sur l'&eacute;tat de sant&eacute; de votre application.</p><p id="-xm8n4d_227">Vous &ecirc;tes maintenant capable de :</p><ul class="list _bullet" id="-xm8n4d_228"><li class="list__item" id="-xm8n4d_233"><p id="-xm8n4d_237">Orchestrer une stack de monitoring compl&egrave;te avec Docker Compose.</p></li><li class="list__item" id="-xm8n4d_234"><p id="-xm8n4d_238">Instrumenter vos services pour qu'ils publient des m&eacute;triques standardis&eacute;es.</p></li><li class="list__item" id="-xm8n4d_235"><p id="-xm8n4d_239">Visualiser en temps r&eacute;el la performance de vos applications.</p></li><li class="list__item" id="-xm8n4d_236"><p id="-xm8n4d_240">Cr&eacute;er des alertes potentielles sur des comportements anormaux (le <code class="code" id="-xm8n4d_241">failureRate</code> de votre Circuit Breaker, le nombre d'erreurs 5xx, etc.).</p></li></ul><p id="-xm8n4d_229">Vous avez fait un pas de g&eacute;ant vers une architecture de qualit&eacute; production. La prochaine &eacute;tape logique est de pouvoir suivre une requ&ecirc;te &agrave; travers tous les services pour analyser les latences. C'est le r&ocirc;le du tracing distribu&eacute;, que nous aborderons dans le prochain module avec Zipkin.</p></section><div class="last-modified">17 juillet 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="011-00-monitoring.html" class="navigation-links__prev">Module 11 : Monitoring et M&eacute;triques (Prometheus &amp; Grafana) - Prendre le pouls du syst&egrave;me</a><a href="012-00-distributed-tracing.html" class="navigation-links__next">Module 12 : Tracing Distribu&eacute; (Zipkin) - Sur la piste de la requ&ecirc;te perdue</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>