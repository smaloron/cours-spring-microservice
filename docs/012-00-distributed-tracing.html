<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-08-01T06:31:07.359343"><title>Module 12 : Tracing Distribu&eacute; (Zipkin) - Sur la piste de la requ&ecirc;te perdue | Spring Micro Services</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs Pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction-le-d-tective-des-temps-de-r-ponse","level":0,"title":"Introduction : Le détective des temps de réponse","anchor":"#introduction-le-d-tective-des-temps-de-r-ponse"},{"id":"les-concepts-cl-s-du-tracing","level":0,"title":"Les Concepts Clés du Tracing","anchor":"#les-concepts-cl-s-du-tracing"},{"id":"notre-bo-te-outils-micrometer-tracing-zipkin","level":0,"title":"Notre Boîte à Outils : Micrometer Tracing \u0026 Zipkin","anchor":"#notre-bo-te-outils-micrometer-tracing-zipkin"},{"id":"conclusion-de-la-partie","level":0,"title":"Conclusion de la partie","anchor":"#conclusion-de-la-partie"},{"id":"auto-valuation","level":0,"title":"Auto-évaluation","anchor":"#auto-valuation"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Module 12 : Tracing Distribu&eacute; (Zipkin) - Sur la piste de la requ&ecirc;te perdue | Spring Micro Services"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Spring Micro Services Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/012-00-distributed-tracing.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Module 12 : Tracing Distribu&eacute; (Zipkin) - Sur la piste de la requ&ecirc;te perdue | Spring Micro Services"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/012-00-distributed-tracing.html#webpage",
    "url": "writerside-documentation/012-00-distributed-tracing.html",
    "name": "Module 12 : Tracing Distribu&eacute; (Zipkin) - Sur la piste de la requ&ecirc;te perdue | Spring Micro Services",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Spring Micro Services Help"
}</script><!-- End Schema.org --></head><body data-id="012-00-distributed-tracing" data-main-title="Module 12 : Tracing Distribué (Zipkin) - Sur la piste de la requête perdue" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Spring Micro Services  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="012-00-distributed-tracing" id="012-00-distributed-tracing.md">Module 12 : Tracing Distribué (Zipkin) - Sur la piste de la requête perdue</h1><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs P&eacute;dagogiques</h2><p id="-gferna_9">&Agrave; la fin de ce module, vous serez capable de :</p><ul class="list _bullet" id="-gferna_10"><li class="list__item" id="-gferna_11"><p id="-gferna_16">Expliquer le probl&egrave;me du d&eacute;bogage des latences dans un syst&egrave;me distribu&eacute;.</p></li><li class="list__item" id="-gferna_12"><p id="-gferna_17">D&eacute;finir les concepts du tracing : Trace, Span et ID de corr&eacute;lation.</p></li><li class="list__item" id="-gferna_13"><p id="-gferna_18">Comprendre le r&ocirc;le de Micrometer Tracing pour l'instrumentation automatique.</p></li><li class="list__item" id="-gferna_14"><p id="-gferna_19">Pr&eacute;senter Zipkin comme un outil de collecte et de visualisation de traces.</p></li><li class="list__item" id="-gferna_15"><p id="-gferna_20">Analyser un diagramme en cascade (waterfall) pour identifier les goulots d'&eacute;tranglement.</p></li></ul></section><section class="chapter"><h2 id="introduction-le-d-tective-des-temps-de-r-ponse" data-toc="introduction-le-d-tective-des-temps-de-r-ponse">Introduction : Le d&eacute;tective des temps de r&eacute;ponse</h2><p id="-gferna_21">Imaginez qu'un utilisateur se plaigne : &quot;Chaque fois que j'ajoute un article &agrave; mon panier, &ccedil;a prend 5 secondes, c'est trop long !&quot;.</p><p id="-gferna_22">Notre tableau de bord Grafana nous confirme qu'il y a un pic de latence sur l'endpoint <code class="code" id="-gferna_25">POST /api/orders</code>. Nos logs nous montrent que la requ&ecirc;te a bien travers&eacute; la Gateway, l'Order Service et le Product Service. Mais <span class="control" id="-gferna_26">O&Ugrave;</span> sont pass&eacute;es ces 5 secondes ?</p><ul class="list _bullet" id="-gferna_23"><li class="list__item" id="-gferna_27"><p id="-gferna_32">Est-ce l'API Gateway qui est lente ?</p></li><li class="list__item" id="-gferna_28"><p id="-gferna_33">Est-ce que l'Order Service passe beaucoup de temps &agrave; traiter la logique avant d'appeler le Product Service ?</p></li><li class="list__item" id="-gferna_29"><p id="-gferna_34">Est-ce que l'appel r&eacute;seau entre les deux services est lent ?</p></li><li class="list__item" id="-gferna_30"><p id="-gferna_35">Est-ce que le Product Service met beaucoup de temps &agrave; r&eacute;pondre ?</p></li><li class="list__item" id="-gferna_31"><p id="-gferna_36">Est-ce que la requ&ecirc;te &agrave; la base de donn&eacute;es du Product Service est le goulot d'&eacute;tranglement ?</p></li></ul><p id="-gferna_24">Ni les logs, ni les m&eacute;triques ne peuvent r&eacute;pondre &agrave; cette question avec pr&eacute;cision. Il nous faut un nouvel outil, un &quot;d&eacute;tective priv&eacute;&quot; capable de suivre une requ&ecirc;te &agrave; la trace, de la chronom&eacute;trer &agrave; chaque &eacute;tape de son parcours et de nous fournir un rapport d&eacute;taill&eacute;. Cet outil, c'est le <span class="control" id="-gferna_37">tracing distribu&eacute;</span>.</p></section><section class="chapter"><h2 id="les-concepts-cl-s-du-tracing" data-toc="les-concepts-cl-s-du-tracing">Les Concepts Cl&eacute;s du Tracing</h2><p id="-gferna_38">Le tracing distribu&eacute; repose sur une structure de donn&eacute;es simple mais puissante.</p><ul class="list _bullet" id="-gferna_39"><li class="list__item" id="-gferna_42"><p id="-gferna_44"><span class="control" id="-gferna_45">Trace :</span> Repr&eacute;sente le parcours complet d'une requ&ecirc;te &agrave; travers l'ensemble du syst&egrave;me. Une trace est un ensemble de &quot;spans&quot;. Elle est identifi&eacute;e par un <span class="control" id="-gferna_46">Trace ID</span> unique, que nous avons d&eacute;j&agrave; rencontr&eacute; dans le module sur les logs.</p></li><li class="list__item" id="-gferna_43"><p id="-gferna_47"><span class="control" id="-gferna_49">Span :</span> Repr&eacute;sente une seule unit&eacute; de travail ou une op&eacute;ration au sein d'une trace. Un appel &agrave; un microservice est un span. Un appel &agrave; une base de donn&eacute;es est un span. Chaque span a :</p><ul class="list _bullet" id="-gferna_48"><li class="list__item" id="-gferna_50"><p id="-gferna_56">Un nom (ex: <code class="code" id="-gferna_57">POST /api/orders</code>).</p></li><li class="list__item" id="-gferna_51"><p id="-gferna_58">Un ID de span unique.</p></li><li class="list__item" id="-gferna_52"><p id="-gferna_59">L'ID de la trace &agrave; laquelle il appartient.</p></li><li class="list__item" id="-gferna_53"><p id="-gferna_60">Un ID de span parent (sauf pour le premier span).</p></li><li class="list__item" id="-gferna_54"><p id="-gferna_61">Un timestamp de d&eacute;but et de fin.</p></li><li class="list__item" id="-gferna_55"><p id="-gferna_62">Des &quot;tags&quot; (m&eacute;tadonn&eacute;es cl&eacute;-valeur, comme l'URL appel&eacute;e, le statut HTTP...).</p></li></ul></li></ul><p id="-gferna_40">L'ensemble des spans d'une m&ecirc;me trace forme une arborescence. C'est cette structure qui nous permet de reconstituer le chemin exact et la chronologie de la requ&ecirc;te.</p><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="653px" preserveAspectRatio="none" style="width:1023px;height:653px;background:#FFFFFF;" version="1.1" viewBox="0 0 1023 653" width="1023px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="272" x="371.425" y="37.1182">Structure d'une Trace</text><g id="elem_Trace"><ellipse cx="99.3543" cy="109.8582" fill="#FFFFFF" rx="88.3543" ry="20.0709" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="136" x="31.3543" y="113.426">Trace ID: a4fde8a1</text></g><g id="elem_A"><ellipse cx="627.3523" cy="109.862" fill="#FFFFFF" rx="97.7523" ry="51.1247" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="51" x="601.8523" y="87.9079">Span A</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="37" x="608.8523" y="104.9225">ID: 1</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="82" x="586.3523" y="121.9372">Parent: null</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="122" x="566.3523" y="138.9518">Service: Gateway</text></g><g id="elem_B"><ellipse cx="627.3502" cy="272.112" fill="#FFFFFF" rx="83.6102" ry="51.1247" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="51" x="601.8502" y="250.1579">Span B</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="37" x="608.8502" y="267.1725">ID: 2</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="65" x="594.8502" y="284.1872">Parent: 1</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="102" x="576.3502" y="301.2018">Service: Order</text></g><g id="elem_C"><ellipse cx="627.3526" cy="434.362" fill="#FFFFFF" rx="92.8026" ry="51.1247" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="51" x="601.8526" y="412.4079">Span C</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="37" x="608.8526" y="429.4225">ID: 3</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="65" x="594.8526" y="446.4372">Parent: 2</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="115" x="569.8526" y="463.4518">Service: Product</text></g><g id="elem_D"><ellipse cx="627.3492" cy="596.612" fill="#FFFFFF" rx="103.4092" ry="51.1247" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="52" x="601.3492" y="574.6579">Span D</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="37" x="608.8492" y="591.6725">ID: 4</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="65" x="594.8492" y="608.6872">Parent: 3</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="130" x="562.3492" y="625.7018">Service: DB Query</text></g><g id="elem_GMN10"><path d="M222.35,89.0573 L222.35,105.8573 L188.13,109.8573 L222.35,113.8573 L222.35,130.6559 A0,0 0 0 0 222.35,130.6559 L494.35,130.6559 A0,0 0 0 0 494.35,130.6559 L494.35,99.0573 L484.35,89.0573 L222.35,89.0573 A0,0 0 0 0 222.35,89.0573 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M484.35,89.0573 L484.35,99.0573 L494.35,99.0573 L484.35,89.0573 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="251" x="228.35" y="107.1271">Une trace est une collection de spans</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="162" x="228.35" y="122.9264">avec le m&#234;me Trace ID.</text></g><g id="elem_GMN13"><path d="M745.85,259.2073 L745.85,268.1073 L711.19,272.1073 L745.85,276.1073 L745.85,285.0066 A0,0 0 0 0 745.85,285.0066 L1016.85,285.0066 A0,0 0 0 0 1016.85,285.0066 L1016.85,269.2073 L1006.85,259.2073 L745.85,259.2073 A0,0 0 0 0 745.85,259.2073 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M1006.85,259.2073 L1006.85,269.2073 L1016.85,269.2073 L1006.85,259.2073 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="250" x="751.85" y="277.2771">Le Span B est un "enfant" du Span A.</text></g><!--link A to B--><g id="link_A_B"><path d="M627.35,161.1173 C627.35,180.1173 627.35,195.7373 627.35,214.7473 " fill="none" id="A-to-B" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="627.35,220.7473,631.35,211.7473,627.35,215.7473,623.35,211.7473,627.35,220.7473" style="stroke:#000000;stroke-width:1.0;"/></g><!--link B to C--><g id="link_B_C"><path d="M627.35,323.3673 C627.35,342.3673 627.35,357.9873 627.35,376.9873 " fill="none" id="B-to-C" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="627.35,382.9873,631.35,373.9873,627.35,377.9873,623.35,373.9873,627.35,382.9873" style="stroke:#000000;stroke-width:1.0;"/></g><!--link C to D--><g id="link_C_D"><path d="M627.35,485.6173 C627.35,504.6173 627.35,520.2273 627.35,539.2373 " fill="none" id="C-to-D" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="627.35,545.2373,631.35,536.2373,627.35,540.2373,623.35,536.2373,627.35,545.2373" style="stroke:#000000;stroke-width:1.0;"/></g><!--SRC=[NP1DQiCm48NtEiNKcxQB59naKR88-0TAeT0KjpjlX3Hk3F8uoAEKNgdNwCKgImARhaRmtlSqysxuZ0F2nSYU1FTi4BA6hLFiB8A-TOJmRgN2J8Yxy83d-W1otsbybFazo2dgNcukag1eQJRaBPsaHU83a3EcfGRjjLTuW2V9-2M_0raag8pGTe7o5V5gDThWBvE_YlxTuj-k_2SxQdz08Af4r97OByHkHTGbl3cqSQbQY08scwF_hGop4bMONg2H4Mp_UMOOktGum8SlYKCtE37CbQdH65JSZmGQOV8RJDudhwZ0Dppy_WofLj_cWq3IC2V_poyzyu8GAqhPa25raZW3xQ9IB05_]--></g></svg></div></section><section class="chapter"><h2 id="notre-bo-te-outils-micrometer-tracing-zipkin" data-toc="notre-bo-te-outils-micrometer-tracing-zipkin">Notre Bo&icirc;te &agrave; Outils : Micrometer Tracing &amp; Zipkin</h2><ul class="list _bullet" id="-gferna_63"><li class="list__item" id="-gferna_70"><p id="-gferna_72"><span class="control" id="-gferna_74">Micrometer Tracing (Le Mouchard) :</span> Comme pour les m&eacute;triques, Micrometer nous fournit une fa&ccedil;ade d'instrumentation. Anciennement, c'&eacute;tait le r&ocirc;le de <span class="control" id="-gferna_75">Spring Cloud Sleuth</span>, qui est maintenant int&eacute;gr&eacute; dans Micrometer. En ajoutant les bonnes d&eacute;pendances, Micrometer va automatiquement &quot;instrumenter&quot; les points de communication de notre application (clients Feign, contr&ocirc;leurs REST, appels JDBC, etc.). Pour chaque op&eacute;ration, il va :</p><ol class="list _decimal" id="-gferna_73" type="1"><li class="list__item" id="-gferna_76"><p id="-gferna_79">Cr&eacute;er un nouveau span (ou continuer une trace existante).</p></li><li class="list__item" id="-gferna_77"><p id="-gferna_80">Mesurer sa dur&eacute;e.</p></li><li class="list__item" id="-gferna_78"><p id="-gferna_81">Propager le contexte (Trace ID, Span ID) aux appels sortants via les en-t&ecirc;tes HTTP (g&eacute;n&eacute;ralement <code class="code" id="-gferna_82">b3</code> ou <code class="code" id="-gferna_83">W3C Trace-Context</code>).</p></li></ol></li><li class="list__item" id="-gferna_71"><p id="-gferna_84"><span class="control" id="-gferna_86">Zipkin (Le Bureau du D&eacute;tective) :</span> Zipkin est un syst&egrave;me de collecte et de visualisation de traces, initialement d&eacute;velopp&eacute; par Twitter. Il est simple et tr&egrave;s efficace. Son r&ocirc;le est de :</p><ol class="list _decimal" id="-gferna_85" type="1"><li class="list__item" id="-gferna_87"><p id="-gferna_91">Recevoir les donn&eacute;es de spans envoy&eacute;es par les microservices.</p></li><li class="list__item" id="-gferna_88"><p id="-gferna_92">Les stocker.</p></li><li class="list__item" id="-gferna_89"><p id="-gferna_93">Les assembler en traces.</p></li><li class="list__item" id="-gferna_90"><p id="-gferna_94">Fournir une interface web pour rechercher des traces et les visualiser sous forme de diagramme en cascade (waterfall).</p></li></ol></li></ul><p id="-gferna_64">Le diagramme en cascade est la repr&eacute;sentation la plus utile. Il montre la dur&eacute;e de chaque span et comment ils s'embo&icirc;tent, rendant les latences imm&eacute;diatement visibles.</p><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="333px" preserveAspectRatio="none" style="width:950px;height:333px;background:#FFFFFF;" version="1.1" viewBox="0 0 950 333" width="950px" zoomAndPan="magnify"><defs/><g><!--cluster Nos Microservices--><g id="cluster_Nos Microservices"><path d="M262.5,11 L404.5,11 A3.75,3.75 0 0 1 407,13.5 L414,34.0146 L632.5,34.0146 A2.5,2.5 0 0 1 635,36.5146 L635,207.51 A2.5,2.5 0 0 1 632.5,210.01 L262.5,210.01 A2.5,2.5 0 0 1 260,207.51 L260,13.5 A2.5,2.5 0 0 1 262.5,11 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="260" x2="414" y1="34.0146" y2="34.0146"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="141" x="264" y="27.0752">Nos Microservices</text></g><!--cluster PS--><g id="cluster_PS"><rect fill="#FFFFFF" height="115.01" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="187" x="416" y="63"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="123" x="448" y="79.0752">Product Service</text></g><!--entity Micrometer--><g id="elem_Micrometer"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="119" x="440.5" y="107"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="539.5" y="112"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="537.5" y="114"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="537.5" y="118"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="79" x="455.5" y="141.0752">Micrometer</text></g><!--entity OS--><g id="elem_OS"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="116" x="276" y="112"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="96" x="286" y="136.0752">Order Service</text></g><!--entity Zipkin--><g id="elem_Zipkin"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="195" x="379.5" y="273.01"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="44" x="389.5" y="297.0852">Zipkin</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="175" x="389.5" y="314.0998">(Collecte &amp; Visualisation)</text></g><!--entity Web Browser--><g id="elem_Web Browser"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="132" x="12" y="276.52"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="124" y="281.52"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="122" y="283.52"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="122" y="287.52"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="92" x="27" y="310.5952">Web Browser</text></g><g id="elem_N1"><path d="M651,109.7 L651,151.2986 L943,151.2986 L943,119.7 L933,109.7 L651,109.7 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M933,109.7 L933,119.7 L943,119.7 L933,109.7 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="271" x="657" y="127.7698">Micrometer Tracing dans chaque service</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="249" x="662" y="143.5691">envoie les donn&#233;es de span &#224; Zipkin.</text></g><!--link PS to Zipkin--><g id="link_PS_Zipkin"><path d="M590.6247,178.0976 C590.5656,178.3867 590.5056,178.6762 590.4449,178.966 C590.3233,179.5457 590.1986,180.1266 590.0707,180.7087 C589.8148,181.8727 589.5457,183.0411 589.263,184.2117 C588.6975,186.553 588.0771,188.9035 587.3964,191.247 C584.6738,200.6213 580.9875,209.885 576,218.01 C562.52,239.97 545.8249,255.1901 526.2449,269.0701 " fill="none" id="PS-to-Zipkin" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="521.35,272.54,531.0056,270.5984,525.4291,269.6484,526.379,264.0719,521.35,272.54" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114" x="571.24" y="240.0798">Envoie ses spans</text></g><!--link OS to Zipkin--><g id="link_OS_Zipkin"><path d="M349.3,149.43 C374.59,179.06 421.3244,233.8066 450.6644,268.1766 " fill="none" id="OS-to-Zipkin" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="454.56,272.74,451.7589,263.2979,451.3137,268.9372,445.6744,268.4919,454.56,272.74" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114" x="427.66" y="240.0798">Envoie ses spans</text></g><!--link Web Browser to Zipkin--><g id="link_Web Browser_Zipkin"><path d="M144.33,300.03 C208.38,300.03 300.11,300.03 373.1,300.03 " fill="none" id="Web Browser-to-Zipkin" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="379.1,300.03,370.1,296.03,374.1,300.03,370.1,304.03,379.1,300.03" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="199" x="162.25" y="294.0998">Montre-moi la trace a4fde8a1</text></g><!--SRC=[ZP0zJWCn48Lxd-BX0a4Hf20AH441eioFj0Wa2CN4EoHMlEF5zWOXbBlGSevS3EzcXGW5OggnvlbxR-OWBRbYr8wigBYoKbEW2iPNjHUMLAGtnsWgTwfKJMP52uOU-uYHDS573cjhE6gyA-GAR1B98l_Gq-3BnYGKEua6HKoBNjVMjmLqnweuST3TUFCRDWabXptKvD-eZL8vT3jxi7LUS2P7rzwv36SSuix6XfoDbAoNumwzaocLqmxAmMN_nWLkPEqj8t94h4cYoY7-dAl7UvxZAlZNVAYdFQqUUKc11vMtS8GKo33exBdaSnfgfSJdU3-smMrMM5cWp62O9RqqhLDta9c0TzOkMvTUPFlPDjp5mFQZjptfrXiFlm00]--></g></svg></div><p id="-gferna_66"><span class="control" id="-gferna_95">Exemple de diagramme en cascade (waterfall) dans Zipkin :</span></p><p id="-gferna_67">Imaginez ce diagramme dans l'interface de Zipkin. On voit instantan&eacute;ment que la requ&ecirc;te &agrave; la base de donn&eacute;es (<code class="code" id="-gferna_96">select product</code>) est la partie la plus longue de toute l'op&eacute;ration.</p><div class="code-block" data-lang="none">
Requête complète ------------------------------------- [ 500ms ]
  api-gateway: GET /api/orders/1 --------------------- [ 495ms ]
    order-service: GET /... -------------------------- [ 480ms ]
      product-service: GET /api/products/123 --------- [ 450ms ]
        db: select product ... ----------------------- [ 400ms ]
</div></section><section class="chapter"><h2 id="conclusion-de-la-partie" data-toc="conclusion-de-la-partie">Conclusion de la partie</h2><p id="-gferna_97">Vous avez maintenant la derni&egrave;re pi&egrave;ce du puzzle de l'observabilit&eacute;. Le <span class="control" id="-gferna_103">tracing distribu&eacute;</span> est l'outil ultime pour comprendre les performances et les goulots d'&eacute;tranglement de votre architecture microservices.</p><p id="-gferna_98">Vous avez appris les concepts fondamentaux de <span class="control" id="-gferna_104">Trace</span> et de <span class="control" id="-gferna_105">Span</span>, et compris comment ils s'assemblent pour raconter l'histoire d'une requ&ecirc;te. Vous avez identifi&eacute; la stack que nous allons utiliser :</p><ul class="list _bullet" id="-gferna_99"><li class="list__item" id="-gferna_106"><p id="-gferna_108"><span class="control" id="-gferna_109">Micrometer Tracing</span> pour instrumenter automatiquement nos applications.</p></li><li class="list__item" id="-gferna_107"><p id="-gferna_110"><span class="control" id="-gferna_111">Zipkin</span> pour collecter et visualiser ces traces.</p></li></ul><p id="-gferna_100">Vous &ecirc;tes maintenant pr&ecirc;t &agrave; r&eacute;pondre non seulement &agrave; &quot;Est-ce que &ccedil;a marche ?&quot; (monitoring), et &quot;Que s'est-il pass&eacute; ?&quot; (logging), mais aussi &agrave; &quot; <span class="control" id="-gferna_112">Pourquoi est-ce lent ?</span> &quot; (tracing).</p><p id="-gferna_101">Dans le TP qui suit, nous allons ajouter Zipkin &agrave; notre &eacute;cosyst&egrave;me, instrumenter nos services, et enfin utiliser l'interface de Zipkin pour traquer une requ&ecirc;te de bout en bout et analyser ses performances.</p></section><section class="chapter"><h2 id="auto-valuation" data-toc="auto-valuation">Auto-&eacute;valuation</h2><ol class="list _decimal" id="-gferna_113" type="1"><li class="list__item" id="-gferna_114"><p id="-gferna_119"><span class="control" id="-gferna_120">(Question ouverte)</span> Quel type de probl&egrave;me le tracing distribu&eacute; r&eacute;sout-il, que ni les logs ni les m&eacute;triques ne peuvent r&eacute;soudre facilement ?</p></li><li class="list__item" id="-gferna_115"><p id="-gferna_121"><span class="control" id="-gferna_123">(QCM)</span> Dans le contexte du tracing, qu'est-ce qu'un &quot;Span&quot; ?</p><ul class="list _bullet" id="-gferna_122"><li class="list__item" id="-gferna_124"><p id="-gferna_128">A) L'ensemble du parcours d'une requ&ecirc;te.</p></li><li class="list__item" id="-gferna_125"><p id="-gferna_129">B) Une seule unit&eacute; de travail ou op&eacute;ration, comme un appel HTTP.</p></li><li class="list__item" id="-gferna_126"><p id="-gferna_130">C) Un log d'erreur.</p></li><li class="list__item" id="-gferna_127"><p id="-gferna_131">D) Un tableau de bord de visualisation.</p></li></ul></li><li class="list__item" id="-gferna_116"><p id="-gferna_132"><span class="control" id="-gferna_134">(QCM)</span> Comment le contexte de trace (Trace ID, Span ID) est-il typiquement propag&eacute; d'un microservice &agrave; un autre ?</p><ul class="list _bullet" id="-gferna_133"><li class="list__item" id="-gferna_135"><p id="-gferna_139">A) Via le corps de la requ&ecirc;te (payload).</p></li><li class="list__item" id="-gferna_136"><p id="-gferna_140">B) Via des en-t&ecirc;tes HTTP sp&eacute;cifiques (ex: B3 headers).</p></li><li class="list__item" id="-gferna_137"><p id="-gferna_141">C) Via une base de donn&eacute;es partag&eacute;e.</p></li><li class="list__item" id="-gferna_138"><p id="-gferna_142">D) Il n'est pas propag&eacute;, chaque service cr&eacute;e une nouvelle trace.</p></li></ul></li><li class="list__item" id="-gferna_117"><p id="-gferna_143"><span class="control" id="-gferna_144">(Question ouverte)</span> Quel outil a &eacute;t&eacute; int&eacute;gr&eacute; dans Micrometer pour fournir la fonctionnalit&eacute; de tracing, rempla&ccedil;ant ainsi un ancien projet de Spring Cloud ?</p></li><li class="list__item" id="-gferna_118"><p id="-gferna_145"><span class="control" id="-gferna_147">(QCM)</span> L'objectif principal de l'analyse d'un diagramme en cascade (waterfall) dans Zipkin est de :</p><ul class="list _bullet" id="-gferna_146"><li class="list__item" id="-gferna_148"><p id="-gferna_152">A) Compter le nombre d'erreurs.</p></li><li class="list__item" id="-gferna_149"><p id="-gferna_153">B) Voir le contenu des logs.</p></li><li class="list__item" id="-gferna_150"><p id="-gferna_154">C) Identifier visuellement les op&eacute;rations qui prennent le plus de temps (latence).</p></li><li class="list__item" id="-gferna_151"><p id="-gferna_155">D) Lister tous les services impliqu&eacute;s.</p></li></ul></li></ol></section><div class="last-modified">17 juillet 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="011-01-tp-11.html" class="navigation-links__prev">TP 11 : Monitoring de l'Architecture avec Prometheus et Grafana</a><a href="012-01-tp-12.html" class="navigation-links__next">TP 12 : Analyse de Requ&ecirc;tes avec Zipkin</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>