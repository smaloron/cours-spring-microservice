<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-27T21:24:57.008817"><title>Module 7 : La Passerelle d'API (API Gateway) (L'essentiel) | Spring Micro Services</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs Pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction-le-videur-du-club","level":0,"title":"Introduction : Le Videur du Club","anchor":"#introduction-le-videur-du-club"},{"id":"pourquoi-ne-pas-exposer-tous-les-services-directement","level":0,"title":"Pourquoi ne pas exposer tous les services directement ?","anchor":"#pourquoi-ne-pas-exposer-tous-les-services-directement"},{"id":"r-le-de-l-api-gateway-le-couteau-suisse-de-vos-apis","level":0,"title":"Rôle de l\u0027API Gateway : Le couteau suisse de vos APIs","anchor":"#r-le-de-l-api-gateway-le-couteau-suisse-de-vos-apis"},{"id":"notre-outil-spring-cloud-gateway","level":0,"title":"Notre Outil : Spring Cloud Gateway","anchor":"#notre-outil-spring-cloud-gateway"},{"id":"conclusion-de-la-partie","level":0,"title":"Conclusion de la partie","anchor":"#conclusion-de-la-partie"},{"id":"auto-valuation","level":0,"title":"Auto-évaluation","anchor":"#auto-valuation"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Module 7 : La Passerelle d'API (API Gateway) (L'essentiel) | Spring Micro Services"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Spring Micro Services Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/007-00-api-gateway.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Module 7 : La Passerelle d'API (API Gateway) (L'essentiel) | Spring Micro Services"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/007-00-api-gateway.html#webpage",
    "url": "writerside-documentation/007-00-api-gateway.html",
    "name": "Module 7 : La Passerelle d'API (API Gateway) (L'essentiel) | Spring Micro Services",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Spring Micro Services Help"
}</script><!-- End Schema.org --></head><body data-id="007-00-api-gateway" data-main-title="Module 7 : La Passerelle d'API (API Gateway) (L'essentiel)" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Spring Micro Services  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="007-00-api-gateway" id="007-00-api-gateway.md">Module 7 : La Passerelle d'API (API Gateway) (L'essentiel)</h1><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs P&eacute;dagogiques</h2><p id="af5th7_10">&Agrave; la fin de cette partie, vous serez capable de :</p><ul class="list _bullet" id="af5th7_11"><li class="list__item" id="af5th7_12"><p id="af5th7_16">Expliquer pourquoi on ne doit pas exposer tous les microservices directement sur Internet.</p></li><li class="list__item" id="af5th7_13"><p id="af5th7_17">Lister les r&ocirc;les principaux d'une API Gateway (point d'entr&eacute;e unique, routage, etc.).</p></li><li class="list__item" id="af5th7_14"><p id="af5th7_18">Pr&eacute;senter Spring Cloud Gateway comme la solution moderne pour impl&eacute;menter ce pattern.</p></li><li class="list__item" id="af5th7_15"><p id="af5th7_19">D&eacute;finir les concepts cl&eacute;s de Spring Cloud Gateway : Route, Pr&eacute;dicat (Predicate) et Filtre (Filter).</p></li></ul></section><section class="chapter"><h2 id="introduction-le-videur-du-club" data-toc="introduction-le-videur-du-club">Introduction : Le Videur du Club</h2><p id="af5th7_20">Imaginez que notre &eacute;cosyst&egrave;me de microservices est une grande bo&icirc;te de nuit. &Agrave; l'int&eacute;rieur, il y a plusieurs salles avec des ambiances diff&eacute;rentes : le bar (<code class="code" id="af5th7_24">product-service</code>), la piste de danse (<code class="code" id="af5th7_25">order-service</code>), le carr&eacute; VIP (<code class="code" id="af5th7_26">payment-service</code>), etc.</p><p id="af5th7_21">Maintenant, imaginez que chaque salle ait sa propre porte d'entr&eacute;e donnant sur la rue. Ce serait le chaos !</p><ul class="list _bullet" id="af5th7_22"><li class="list__item" id="af5th7_27"><p id="af5th7_31">Les clients (utilisateurs de l'API) seraient perdus, ne sachant pas &agrave; quelle porte frapper.</p></li><li class="list__item" id="af5th7_28"><p id="af5th7_32">Il faudrait mettre un videur (syst&egrave;me de s&eacute;curit&eacute;) &agrave; chaque porte.</p></li><li class="list__item" id="af5th7_29"><p id="af5th7_33">Chaque salle devrait g&eacute;rer elle-m&ecirc;me la file d'attente (limitation de d&eacute;bit).</p></li><li class="list__item" id="af5th7_30"><p id="af5th7_34">Il serait impossible de savoir combien de personnes sont dans le club au total (monitoring centralis&eacute;).</p></li></ul><p id="af5th7_23">La solution &eacute;vidente est d'avoir une <span class="control" id="af5th7_35">seule entr&eacute;e principale</span> avec un grand panneau lumineux, et un (ou plusieurs) videur(s) qui g&egrave;re(nt) l'acc&egrave;s, v&eacute;rifie(nt) les identit&eacute;s et oriente(nt) les gens vers la bonne salle. Ce videur, c'est notre <span class="control" id="af5th7_36">API Gateway</span>.</p></section><section class="chapter"><h2 id="pourquoi-ne-pas-exposer-tous-les-services-directement" data-toc="pourquoi-ne-pas-exposer-tous-les-services-directement">Pourquoi ne pas exposer tous les services directement ?</h2><p id="af5th7_37">Exposer chaque microservice directement sur Internet est une anti-pratique pour plusieurs raisons critiques :</p><ol class="list _decimal" id="af5th7_38" type="1"><li class="list__item" id="af5th7_39"><p id="af5th7_43"><span class="control" id="af5th7_44">Complexit&eacute; pour le client :</span> Le client (une application mobile, un front-end web) devrait conna&icirc;tre l'adresse de chaque microservice. C'est lourd et fragile. Si on ajoute ou modifie un service, tous les clients doivent &ecirc;tre mis &agrave; jour.</p></li><li class="list__item" id="af5th7_40"><p id="af5th7_45"><span class="control" id="af5th7_46">Probl&egrave;mes de s&eacute;curit&eacute; :</span> Chaque service expos&eacute; publiquement est une porte d'entr&eacute;e potentielle pour une attaque. Il faudrait impl&eacute;menter la s&eacute;curit&eacute; (authentification, autorisation, protection DDoS) sur CHAQUE service, ce qui est redondant et source d'erreurs.</p></li><li class="list__item" id="af5th7_41"><p id="af5th7_47"><span class="control" id="af5th7_48">Gestion des probl&eacute;matiques transversales :</span> Des besoins comme la limitation de d&eacute;bit (rate limiting), la journalisation des requ&ecirc;tes (logging), la mise en cache ou la collecte de m&eacute;triques devraient &ecirc;tre r&eacute;impl&eacute;ment&eacute;s partout. C'est inefficace.</p></li><li class="list__item" id="af5th7_42"><p id="af5th7_49"><span class="control" id="af5th7_50">Protocoles non web :</span> Certains services internes pourraient communiquer avec des protocoles non-HTTP (comme gRPC ou des messages AMQP). Une gateway peut traduire ces protocoles en HTTP pour les clients externes.</p></li></ol></section><section class="chapter"><h2 id="r-le-de-l-api-gateway-le-couteau-suisse-de-vos-apis" data-toc="r-le-de-l-api-gateway-le-couteau-suisse-de-vos-apis">R&ocirc;le de l'API Gateway : Le couteau suisse de vos APIs</h2><p id="af5th7_51">L'API Gateway est un service qui se place en fa&ccedil;ade de tous les autres. C'est le <span class="control" id="af5th7_55">point d'entr&eacute;e unique</span> (Single Point of Entry) pour toutes les requ&ecirc;tes externes. Elle agit comme un reverse proxy intelligent, examinant les requ&ecirc;tes entrantes et les redirigeant vers le service interne appropri&eacute;.</p><p id="af5th7_52">Ses missions principales sont :</p><ul class="list _bullet" id="af5th7_53"><li class="list__item" id="af5th7_56"><p id="af5th7_61"><span class="control" id="af5th7_62">Routage (Routing) :</span> C'est sa fonction de base. Elle redirige une requ&ecirc;te (<code class="code" id="af5th7_63">/api/products/1</code>) vers le bon service (<code class="code" id="af5th7_64">product-service</code>).</p></li><li class="list__item" id="af5th7_57"><p id="af5th7_65"><span class="control" id="af5th7_66">S&eacute;curit&eacute; :</span> Elle peut centraliser l'authentification. Elle v&eacute;rifie si la requ&ecirc;te contient un token valide (ex: JWT) avant de la laisser passer. Les services internes peuvent alors se faire confiance.</p></li><li class="list__item" id="af5th7_58"><p id="af5th7_67"><span class="control" id="af5th7_68">D&eacute;couplage :</span> Elle masque la structure interne de votre syst&egrave;me. Le client ne voit qu'une seule API, m&ecirc;me si derri&egrave;re se cachent 50 microservices.</p></li><li class="list__item" id="af5th7_59"><p id="af5th7_69"><span class="control" id="af5th7_70">Qualit&eacute; de Service (Cross-cutting concerns) :</span> Elle peut appliquer des filtres pour g&eacute;rer la limitation de d&eacute;bit, la mise en cache, la transformation de requ&ecirc;tes/r&eacute;ponses, l'ajout d'en-t&ecirc;tes, etc.</p></li><li class="list__item" id="af5th7_60"><p id="af5th7_71"><span class="control" id="af5th7_72">Agr&eacute;gation (optionnel) :</span> Elle peut recevoir une seule requ&ecirc;te du client et faire plusieurs appels &agrave; des services internes pour agr&eacute;ger les r&eacute;ponses en une seule.</p></li></ul><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="679px" preserveAspectRatio="none" style="width:745px;height:679px;background:#FFFFFF;" version="1.1" viewBox="0 0 745 679" width="745px" zoomAndPan="magnify"><defs/><g><!--cluster Notre Ecosyst?me--><g id="cluster_Notre Ecosyst&#232;me"><path d="M13.5,214.02 L155.5,214.02 A3.75,3.75 0 0 1 158,216.52 L165,237.0346 L515.5,237.0346 A2.5,2.5 0 0 1 518,239.5346 L518,669.66 A2.5,2.5 0 0 1 515.5,672.16 L13.5,672.16 A2.5,2.5 0 0 1 11,669.66 L11,216.52 A2.5,2.5 0 0 1 13.5,214.02 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="11" x2="165" y1="237.0346" y2="237.0346"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="141" x="15" y="230.0952">Notre Ecosyst&#232;me</text></g><!--cluster gateway--><g id="cluster_gateway"><rect fill="#FFFFFF" height="236.12" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="294" x="117" y="404.04"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="101" x="213.5" y="420.1152">API Gateway</text></g><!--cluster Services Internes (priv?s)--><g id="cluster_Services Internes (priv&#233;s)"><path d="M54.5,258.02 L261.5,258.02 A3.75,3.75 0 0 1 264,260.52 L271,281.0346 L356.5,281.0346 A2.5,2.5 0 0 1 359,283.5346 L359,344.54 A2.5,2.5 0 0 1 356.5,347.04 L54.5,347.04 A2.5,2.5 0 0 1 52,344.54 L52,260.52 A2.5,2.5 0 0 1 54.5,258.02 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="52" x2="271" y1="281.0346" y2="281.0346"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="206" x="56" y="274.0952">Services Internes (priv&#233;s)</text></g><!--entity R--><g id="elem_R"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="95" x="140.5" y="448.04"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="215.5" y="453.04"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="213.5" y="455.04"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="213.5" y="459.04"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="55" x="155.5" y="482.1152">Routing</text></g><!--entity S--><g id="elem_S"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="98" x="270" y="448.04"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="348" y="453.04"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="346" y="455.04"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="346" y="459.04"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="58" x="285" y="482.1152">Security</text></g><!--entity RL--><g id="elem_RL"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="135" x="141.5" y="569.15"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="256.5" y="574.15"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="254.5" y="576.15"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="254.5" y="580.15"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="95" x="156.5" y="603.2252">Rate Limiting</text></g><!--entity ps--><g id="elem_ps"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="128" x="215" y="294.02"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="108" x="225" y="318.0952">product-service</text></g><!--entity os--><g id="elem_os"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="111" x="68.5" y="294.02"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="91" x="78.5" y="318.0952">order-service</text></g><!--entity client--><g id="elem_client"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="114" x="468" y="12"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="562" y="17"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="560" y="19"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="560" y="23"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="74" x="483" y="46.0752">Client App</text></g><!--entity net--><g id="elem_net"><path d="M491.1902,128.7149 C493.895,123.3012 497.5259,122.1965 501.6254,127.3358 C504.2069,121.0296 510.4751,119.0897 514.8706,125.4369 C517.9958,119.6541 522.3115,118.619 527.1905,123.3895 C530.8689,119.768 534.9616,120.8284 537.0349,125.3337 C541.5309,118.6701 547.5906,119.0869 551.1739,126.266 C556.3622,123.0326 559.9937,124.1374 562.1715,129.933 C569.9409,131.7406 570.4739,138.3525 565.8799,143.5316 C571.8441,150.035 570.6383,155.6922 563.112,159.9168 C560.5693,166.6602 554.4879,168.6853 549.0975,163.1732 C548.0151,168.8579 543.4505,171.6859 538.5774,167.0295 C536.2039,174.5771 531.9421,173.989 526.6748,170.0204 C520.2072,175.4077 515.4869,172.8801 513.5623,165.3933 C508.9027,169.6501 504.9619,168.0811 502.4883,162.8435 C497.9386,168.6315 492.3532,166.3785 490.1401,160.3929 C481.6733,156.8215 480.4325,150.375 487.7892,144.4677 C481.6143,137.7143 482.3784,132.2327 491.1902,128.7149 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="58" x="496" y="149.0852">Internet</text></g><g id="elem_GMN18"><path d="M534,434.95 L534,508.1473 L738,508.1473 L738,444.95 L728,434.95 L534,434.95 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M728,434.95 L728,444.95 L738,444.95 L728,434.95 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132" x="540" y="453.0198">Je suis le seul point</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="183" x="540" y="468.8191">de contact avec l'ext&#233;rieur.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="156" x="540" y="484.6185">Je prot&#232;ge et orchestre</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143" x="540" y="500.4178">les services internes.</text></g><!--link client to net--><g id="link_client_net"><path d="M525,59.51 C525,77.29 525,95.79 525,113.56 " fill="none" id="client-to-net" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="525,119.56,529,110.56,525,114.56,521,110.56,525,119.56" style="stroke:#000000;stroke-width:1.0;"/></g><!--link net to gateway--><g id="link_net_gateway"><path d="M528.11,167.41 C532.97,211.29 538.48,309.17 503,380.04 C489.79,406.42 465.36,428.7575 443.9537,444.6412 C433.2506,452.5831 423.3034,458.9116 415.8927,463.3252 C414.9663,463.8769 414.0796,464.3986 413.236,464.8899 C412.8142,465.1355 412.4032,465.3736 412.0033,465.6039 C411.8034,465.719 411.6063,465.8322 411.4121,465.9435 C411.315,465.9992 416.428,463.0775 416.3323,463.1322 " fill="none" id="net-to-gateway" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="411.1229,466.109,420.9216,465.1167,415.4641,463.6283,416.9525,458.1708,411.1229,466.109" style="stroke:#000000;stroke-width:1.0;"/></g><!--reverse link ps to gateway--><g id="link_ps_gateway"><path d="M276.9081,337.3163 C276.3681,352.5963 278.61,368.01 292,380.04 C307.26,393.76 368.51,374.58 384,388.04 C387.4388,391.03 390.3233,394.5058 392.7374,398.3058 C393.3409,399.2559 393.9151,400.2261 394.4611,401.2142 C394.7341,401.7082 395.0001,402.2066 395.2593,402.7092 C395.3888,402.9605 395.5167,403.2128 395.6428,403.4661 C395.7059,403.5928 395.7686,403.7197 395.8308,403.8468 " fill="none" id="ps-backto-gateway" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="277.12,331.32,272.8046,340.1731,276.9434,336.3169,280.7996,340.4557,277.12,331.32" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205" x="293" y="377.1098">Requ&#234;te pour /api/products/**</text></g><!--reverse link os to gateway--><g id="link_os_gateway"><path d="M94.5654,335.3924 C77.8454,349.5824 65.8,365.46 80,380.04 C91.79,392.14 370.92,377.35 384,388.04 C387.5275,390.9237 390.4792,394.3189 392.9429,398.0593 C394.1747,399.9296 395.2846,401.8861 396.2833,403.9082 " fill="none" id="os-backto-gateway" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="99.14,331.51,89.6898,334.2839,95.3278,334.7453,94.8664,340.3833,99.14,331.51" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="191" x="81" y="377.1098">Requ&#234;te pour /api/orders/**</text></g><!--link gateway to GMN18--><g id="link_gateway_GMN18"><path d="M411.0977,471.55 C411.2674,471.55 411.4371,471.55 411.6069,471.55 C414.3225,471.55 417.0381,471.55 419.7537,471.55 C425.185,471.55 430.6163,471.55 436.0475,471.55 C446.91,471.55 457.7725,471.55 468.635,471.55 C490.36,471.55 512.085,471.55 533.81,471.55 " fill="none" id="gateway-GMN18" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/></g><!--SRC=[TLB1IWCn4BtdAyQzg8LjmQC7eOX8fOXqZ-8XPCTjQ3Q9cQHQnF-n_aP_p6bsMrkeWP19vitBcyUSnJcs2Dv8RGKjjFKoo1QKQxspQ6CLLmOXjUPAYETRe_a9njw_W2HG-IgKSQc6Oc8Z1eknsARu5C9BjP0DGl7eOa2uKuvM53VVBHRmAO1NG1MbRVY7OlmqWNiPyLskCaFJnJrmk_QQe9Yv5BLjCd1s2b2XIa77ZgewIS7yCDMj_YEQPjoNoCTUV8LXgHKIz0qINFYWbvirNHO7wWvQyS7LISMIkifCxkaKqeKQmn7EKI-2PNJ-GbdUP3zvSyoNtXeXTXwLYLyzmJNCy2rjVhWpxrA0aVHwrAkXqM1mNE3-ASYYCbnOnvcWcta4zxh_5-01WP8cu1u8a-5YpOC0K2DRRADK4UGI5PXp_8YRTT2Omh2hOpay0cmiT-E2cYFnR73AiB6qirhtLWy5sXgsAiGl]--></g></svg></div></section><section class="chapter"><h2 id="notre-outil-spring-cloud-gateway" data-toc="notre-outil-spring-cloud-gateway">Notre Outil : Spring Cloud Gateway</h2><p id="af5th7_73">Pendant longtemps, Netflix Zuul &eacute;tait la solution de gateway fournie par Spring Cloud. Comme Hystrix, Zuul est maintenant en mode maintenance. La solution moderne, non-bloquante et r&eacute;active est <span class="control" id="af5th7_76">Spring Cloud Gateway</span>. Elle est construite sur Project Reactor, Netty et Spring WebFlux, ce qui la rend extr&ecirc;mement performante et capable de g&eacute;rer un grand nombre de connexions simultan&eacute;es.</p><section class="chapter"><h3 id="les-concepts-cl-s-de-spring-cloud-gateway" data-toc="les-concepts-cl-s-de-spring-cloud-gateway">Les Concepts Cl&eacute;s de Spring Cloud Gateway</h3><p id="af5th7_77">La configuration de la Gateway repose sur trois briques fondamentales :</p><ol class="list _decimal" id="af5th7_78" type="1"><li class="list__item" id="af5th7_80"><p id="af5th7_83"><span class="control" id="af5th7_84">Route :</span> C'est l'&eacute;l&eacute;ment de base. Une route est d&eacute;finie par un ID unique, une URI de destination, une collection de pr&eacute;dicats et une collection de filtres. Si les pr&eacute;dicats sont satisfaits, la requ&ecirc;te est envoy&eacute;e vers l'URI.</p></li><li class="list__item" id="af5th7_81"><p id="af5th7_85"><span class="control" id="af5th7_87">Pr&eacute;dicat (Predicate) :</span> C'est une condition qui doit &ecirc;tre vraie pour que la route soit activ&eacute;e. Spring Cloud Gateway fournit de nombreux pr&eacute;dicats pr&ecirc;ts &agrave; l'emploi. Le plus courant est <code class="code" id="af5th7_88">Path</code>, qui v&eacute;rifie si le chemin de la requ&ecirc;te correspond &agrave; un certain pattern.</p><ul class="list _bullet" id="af5th7_86"><li class="list__item" id="af5th7_89"><p id="af5th7_90">Exemple : <code class="code" id="af5th7_91">Path=/api/products/**</code>-&gt; Ce pr&eacute;dicat est vrai pour <code class="code" id="af5th7_92">/api/products/1</code> ou <code class="code" id="af5th7_93">/api/products/all</code>, mais pas pour <code class="code" id="af5th7_94">/api/orders/5</code>.</p></li></ul></li><li class="list__item" id="af5th7_82"><p id="af5th7_95"><span class="control" id="af5th7_97">Filtre (Filter) :</span> C'est une logique qui peut modifier la requ&ecirc;te entrante ou la r&eacute;ponse sortante. On peut les appliquer de mani&egrave;re globale ou sp&eacute;cifique &agrave; une route.</p><ul class="list _bullet" id="af5th7_96"><li class="list__item" id="af5th7_98"><p id="af5th7_100">Exemple de filtre de requ&ecirc;te : Ajouter un en-t&ecirc;te (<code class="code" id="af5th7_101">X-Request-Source: Gateway</code>).</p></li><li class="list__item" id="af5th7_99"><p id="af5th7_102">Exemple de filtre de r&eacute;ponse : Ajouter un en-t&ecirc;te de s&eacute;curit&eacute; (<code class="code" id="af5th7_103">X-Frame-Options: DENY</code>).</p></li></ul></li></ol><p id="af5th7_79">Le flux d'une requ&ecirc;te dans la Gateway est le suivant : <span class="control" id="af5th7_104">Requ&ecirc;te entrante -&gt; Mapping de la route (Pr&eacute;dicats) -&gt; Filtres pr&eacute;-routage -&gt; Appel du service cible -&gt; Filtres post-routage -&gt; R&eacute;ponse sortante</span></p></section><section class="chapter"><h3 id="configuration-l-approche-d-clarative" data-toc="configuration-l-approche-d-clarative">Configuration : L'approche d&eacute;clarative</h3><p id="af5th7_105">La mani&egrave;re la plus simple de configurer Spring Cloud Gateway est d'utiliser le fichier <code class="code" id="af5th7_112">application.yml</code> (le format YAML est plus lisible que <code class="code" id="af5th7_113">.properties</code> pour les structures imbriqu&eacute;es).</p><p id="af5th7_106">Voici &agrave; quoi ressemblerait une configuration pour notre projet &quot;GestBook&quot; :</p><div class="code-block" data-lang="yaml">
# Configuration dans application.yml de la Gateway
server:
  port: 8080 # Le port public de notre application

spring:
  application:
    name: api-gateway
  cloud:
    gateway:
      routes:
        # Première route : pour le service produit
        - id: product-service-route
          # URI de destination. 'lb' signifie &quot;Load Balancer&quot;.
          # La gateway va utiliser Eureka pour trouver une instance de 'product-service'.
          uri: lb://product-service
          predicates:
            # Cette route s'active si le chemin commence par /api/products/
            - Path=/api/products/**

        # Seconde route : pour le service commande
        - id: order-service-route
          uri: lb://order-service
          predicates:
            - Path=/api/orders/**
</div><p id="af5th7_108">Avec cette configuration :</p><ul class="list _bullet" id="af5th7_109"><li class="list__item" id="af5th7_114"><p id="af5th7_116">Une requ&ecirc;te <code class="code" id="af5th7_117">GET http://localhost:8080/api/products/1</code> sera intercept&eacute;e par la Gateway. Le pr&eacute;dicat <code class="code" id="af5th7_118">Path</code> de la premi&egrave;re route correspondra. La Gateway demandera &agrave; Eureka l'adresse de <code class="code" id="af5th7_119">product-service</code> et lui transmettra la requ&ecirc;te.</p></li><li class="list__item" id="af5th7_115"><p id="af5th7_120">Une requ&ecirc;te <code class="code" id="af5th7_121">POST http://localhost:8080/api/orders</code> correspondra &agrave; la seconde route et sera dirig&eacute;e vers <code class="code" id="af5th7_122">order-service</code>.</p></li></ul><p id="af5th7_110">Le <code class="code" id="af5th7_123">lb://</code> est crucial : il indique &agrave; la Gateway d'utiliser son int&eacute;gration avec le client de d&eacute;couverte (Eureka dans notre cas) pour r&eacute;soudre le nom du service en une adresse IP et un port concrets, tout en faisant de la r&eacute;partition de charge si plusieurs instances sont disponibles.</p></section></section><section class="chapter"><h2 id="conclusion-de-la-partie" data-toc="conclusion-de-la-partie">Conclusion de la partie</h2><p id="af5th7_124">Vous comprenez maintenant le r&ocirc;le indispensable de l' <span class="control" id="af5th7_128">API Gateway</span> en tant que gardien et chef d'orchestre de votre architecture. C'est le composant qui apporte de l'ordre, de la s&eacute;curit&eacute; et de la coh&eacute;rence &agrave; un syst&egrave;me distribu&eacute; qui pourrait autrement &ecirc;tre chaotique.</p><p id="af5th7_125">Vous avez d&eacute;couvert <span class="control" id="af5th7_129">Spring Cloud Gateway</span>, la solution moderne et performante de l'&eacute;cosyst&egrave;me Spring, et vous ma&icirc;trisez ses trois concepts fondamentaux : les <span class="control" id="af5th7_130">Routes</span>, les <span class="control" id="af5th7_131">Pr&eacute;dicats</span> et les <span class="control" id="af5th7_132">Filtres</span>. Vous avez vu &agrave; quel point la configuration d&eacute;clarative en YAML est puissante, notamment avec l'int&eacute;gration du load balancing (<code class="code" id="af5th7_133">lb://</code>) qui tire parti de notre infrastructure de d&eacute;couverte de services.</p><p id="af5th7_126">Dans le TP suivant, nous allons construire et configurer notre propre API Gateway. Nous la placerons en amont de nos services et validerons que nous pouvons acc&eacute;der &agrave; l'ensemble de notre &eacute;cosyst&egrave;me en passant uniquement par ce point d'entr&eacute;e unique.</p></section><section class="chapter"><h2 id="auto-valuation" data-toc="auto-valuation">Auto-&eacute;valuation</h2><p id="af5th7_134">Prenez un moment pour r&eacute;pondre &agrave; ces questions. Les corrections se trouvent &agrave; la toute fin du support de cours.</p><ol class="list _decimal" id="af5th7_135" type="1"><li class="list__item" id="af5th7_136"><p id="af5th7_141"><span class="control" id="af5th7_142">(Question ouverte)</span> Citez trois raisons pour lesquelles il est d&eacute;conseill&eacute; d'exposer chaque microservice directement sur Internet.</p></li><li class="list__item" id="af5th7_137"><p id="af5th7_143"><span class="control" id="af5th7_145">(QCM)</span> Quel est le r&ocirc;le principal d'un &quot;Pr&eacute;dicat&quot; dans Spring Cloud Gateway ?</p><ul class="list _bullet" id="af5th7_144"><li class="list__item" id="af5th7_146"><p id="af5th7_150">A) Modifier le contenu de la requ&ecirc;te.</p></li><li class="list__item" id="af5th7_147"><p id="af5th7_151">B) D&eacute;finir la destination de la requ&ecirc;te.</p></li><li class="list__item" id="af5th7_148"><p id="af5th7_152">C) D&eacute;finir une condition qui doit &ecirc;tre remplie pour qu'une route soit choisie.</p></li><li class="list__item" id="af5th7_149"><p id="af5th7_153">D) Mesurer le temps de r&eacute;ponse.</p></li></ul></li><li class="list__item" id="af5th7_138"><p id="af5th7_154"><span class="control" id="af5th7_156">(QCM)</span> Dans l'URI d'une route, que signifie le pr&eacute;fixe <code class="code" id="af5th7_157">lb://</code> (ex: <code class="code" id="af5th7_158">uri: lb://product-service</code>) ?</p><ul class="list _bullet" id="af5th7_155"><li class="list__item" id="af5th7_159"><p id="af5th7_163">A) Que l'URI est une adresse locale (<code class="code" id="af5th7_164">localhost</code>).</p></li><li class="list__item" id="af5th7_160"><p id="af5th7_165">B) Que la Gateway doit utiliser son client de d&eacute;couverte de services (comme Eureka) pour trouver et r&eacute;partir la charge vers le service nomm&eacute;.</p></li><li class="list__item" id="af5th7_161"><p id="af5th7_166">C) Que la communication doit &ecirc;tre chiffr&eacute;e.</p></li><li class="list__item" id="af5th7_162"><p id="af5th7_167">D) Que le service de destination est une base de donn&eacute;es (<code class="code" id="af5th7_168">local base</code>).</p></li></ul></li><li class="list__item" id="af5th7_139"><p id="af5th7_169"><span class="control" id="af5th7_170">(Question ouverte)</span> Une requ&ecirc;te <code class="code" id="af5th7_171">GET /api/v2/products/info</code> arrive sur la Gateway. La premi&egrave;re route a un pr&eacute;dicat <code class="code" id="af5th7_172">Path=/api/products/**</code> et la seconde a <code class="code" id="af5th7_173">Path=/api/v2/products/**</code>. Vers quelle route la Gateway va-t-elle diriger la requ&ecirc;te et pourquoi ?</p></li><li class="list__item" id="af5th7_140"><p id="af5th7_174"><span class="control" id="af5th7_176">(QCM)</span> Quel projet Spring Cloud Gateway a-t-il remplac&eacute; en tant que solution de gateway recommand&eacute;e ?</p><ul class="list _bullet" id="af5th7_175"><li class="list__item" id="af5th7_177"><p id="af5th7_181">A) Spring Cloud Config</p></li><li class="list__item" id="af5th7_178"><p id="af5th7_182">B) Netflix Eureka</p></li><li class="list__item" id="af5th7_179"><p id="af5th7_183">C) Netflix Hystrix</p></li><li class="list__item" id="af5th7_180"><p id="af5th7_184">D) Netflix Zuul</p></li></ul></li></ol></section><div class="last-modified">17 juillet 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="006-01-tp-6.html" class="navigation-links__prev">TP 6 : &quot;Houston, nous avons un probl&egrave;me&quot; - Impl&eacute;mentation d'un Circuit Breaker</a><a href="007-01-tp-7.html" class="navigation-links__next">TP 7 : Le Grand Portail - Mise en place de l'API Gateway</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>