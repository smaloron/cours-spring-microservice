<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-31T13:08:48.084839"><title>Module 2 : Cas d'&eacute;tude et Premier Microservice | Spring Micro Services</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs Pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction-de-la-th-orie-la-pratique","level":0,"title":"Introduction : De la théorie à la pratique","anchor":"#introduction-de-la-th-orie-la-pratique"},{"id":"notre-projet-fil-rouge-gestbook","level":0,"title":"Notre Projet Fil Rouge : \"GestBook\"","anchor":"#notre-projet-fil-rouge-gestbook"},{"id":"cr-ation-de-notre-premier-microservice-product-service","level":0,"title":"Création de notre premier Microservice : product-service","anchor":"#cr-ation-de-notre-premier-microservice-product-service"},{"id":"impl-mentation-de-la-logique-m-tier","level":0,"title":"Implémentation de la logique métier","anchor":"#impl-mentation-de-la-logique-m-tier"},{"id":"hydrater-la-base-de-donn-es-pour-les-tests","level":0,"title":"Hydrater la base de données pour les tests","anchor":"#hydrater-la-base-de-donn-es-pour-les-tests"},{"id":"lancement-et-validation","level":0,"title":"Lancement et validation","anchor":"#lancement-et-validation"},{"id":"exercice-3-ajouter-un-endpoint-de-cr-ation","level":0,"title":"Exercice 3 : Ajouter un endpoint de création","anchor":"#exercice-3-ajouter-un-endpoint-de-cr-ation"},{"id":"auto-valuation","level":0,"title":"Auto-évaluation","anchor":"#auto-valuation"},{"id":"conclusion","level":0,"title":"Conclusion","anchor":"#conclusion"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Module 2 : Cas d'&eacute;tude et Premier Microservice | Spring Micro Services"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Spring Micro Services Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/002-00-first-micro-service.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Module 2 : Cas d'&eacute;tude et Premier Microservice | Spring Micro Services"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/002-00-first-micro-service.html#webpage",
    "url": "writerside-documentation/002-00-first-micro-service.html",
    "name": "Module 2 : Cas d'&eacute;tude et Premier Microservice | Spring Micro Services",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Spring Micro Services Help"
}</script><!-- End Schema.org --></head><body data-id="002-00-first-micro-service" data-main-title="Module 2 : Cas d'étude et Premier Microservice" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Spring Micro Services  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="002-00-first-micro-service" id="002-00-first-micro-service.md">Module 2 : Cas d'étude et Premier Microservice</h1><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs P&eacute;dagogiques</h2><p id="-s7skff_13">&Agrave; la fin de ce module, vous serez capable de :</p><ul class="list _bullet" id="-s7skff_14"><li class="list__item" id="-s7skff_15"><p id="-s7skff_19">D&eacute;crire l'application fil rouge &quot;GestBook&quot; que nous allons construire.</p></li><li class="list__item" id="-s7skff_16"><p id="-s7skff_20">Justifier le d&eacute;coupage fonctionnel en microservices de cette application.</p></li><li class="list__item" id="-s7skff_17"><p id="-s7skff_21">Cr&eacute;er, configurer et lancer un premier microservice Spring Boot.</p></li><li class="list__item" id="-s7skff_18"><p id="-s7skff_22">Exposer une API REST simple avec Spring Web.</p></li></ul></section><section class="chapter"><h2 id="introduction-de-la-th-orie-la-pratique" data-toc="introduction-de-la-th-orie-la-pratique">Introduction : De la th&eacute;orie &agrave; la pratique</h2><p id="-s7skff_23">Jusqu'&agrave; pr&eacute;sent, nous avons beaucoup parl&eacute; de concepts : monolithe, microservices, scalabilit&eacute;, r&eacute;silience... Il est temps de rendre tout cela tangible. Pour apprendre &agrave; construire une architecture microservices, rien de mieux que d'en construire une, pi&egrave;ce par pi&egrave;ce.</p><p id="-s7skff_24">C'est pourquoi nous allons travailler sur un projet fil rouge tout au long de ce cours. L'id&eacute;e n'est pas de construire une application de production compl&egrave;te, mais un <span class="control" id="-s7skff_26">squelette fonctionnel</span> qui nous servira de terrain de jeu pour explorer chaque concept de Spring Cloud.</p><p id="-s7skff_25">Aujourd'hui, nous allons dessiner les plans de notre future application &quot;GestBook&quot;, une version simplifi&eacute;e de notre plateforme de vente de livres, et nous allons poser la premi&egrave;re brique : le service qui g&egrave;re les produits. Pr&eacute;parez votre IDE, l'aventure du code commence maintenant !</p></section><section class="chapter"><h2 id="notre-projet-fil-rouge-gestbook" data-toc="notre-projet-fil-rouge-gestbook">Notre Projet Fil Rouge : &quot;GestBook&quot;</h2><p id="-s7skff_27">&quot;GestBook&quot; est une application e-commerce minimaliste pour la vente de livres. Elle permettra de r&eacute;aliser les actions de base d'un site de vente en ligne.</p><section class="chapter"><h3 id="fonctionnalit-s-cibles" data-toc="fonctionnalit-s-cibles">Fonctionnalit&eacute;s Cibles :</h3><ol class="list _decimal" id="-s7skff_30" type="1"><li class="list__item" id="-s7skff_31"><p id="-s7skff_34"><span class="control" id="-s7skff_35">Gestion du Catalogue :</span> L'application doit permettre de lister les livres disponibles, de voir le d&eacute;tail d'un livre (titre, auteur, prix) et d'ajouter de nouveaux livres (pour les administrateurs).</p></li><li class="list__item" id="-s7skff_32"><p id="-s7skff_36"><span class="control" id="-s7skff_37">Gestion des Commandes :</span> Un utilisateur (pour l'instant anonyme) doit pouvoir cr&eacute;er une commande contenant un ou plusieurs livres.</p></li><li class="list__item" id="-s7skff_33"><p id="-s7skff_38"><span class="control" id="-s7skff_39">Consultation :</span> Il doit &ecirc;tre possible de r&eacute;cup&eacute;rer les d&eacute;tails d'une commande pass&eacute;e, incluant les informations sur les livres qu'elle contient.</p></li></ol></section><section class="chapter"><h3 id="le-d-coupage-fonctionnel-en-microservices" data-toc="le-d-coupage-fonctionnel-en-microservices">Le D&eacute;coupage Fonctionnel en Microservices</h3><p id="-s7skff_40">En nous basant sur le principe de responsabilit&eacute; unique, nous allons d&eacute;couper &quot;GestBook&quot; en deux services principaux pour commencer. C'est un d&eacute;coupage simple, mais suffisant pour explorer la communication inter-services, qui est au c&oelig;ur de notre apprentissage.</p><ol class="list _decimal" id="-s7skff_41" type="1"><li class="list__item" id="-s7skff_44"><p id="-s7skff_46"><span class="control" id="-s7skff_48"><code class="code" id="-s7skff_49">product-service</code> (Service Produit)</span></p><ul class="list _bullet" id="-s7skff_47"><li class="list__item" id="-s7skff_50"><p id="-s7skff_53"><span class="control" id="-s7skff_54">Responsabilit&eacute; :</span> C'est le ma&icirc;tre du catalogue de livres. Il g&egrave;re toutes les informations relatives aux produits : cr&eacute;ation, lecture, mise &agrave; jour, suppression (CRUD). Il ne sait rien des commandes ou des clients.</p></li><li class="list__item" id="-s7skff_51"><p id="-s7skff_55"><span class="control" id="-s7skff_56">Base de donn&eacute;es :</span> Il aura sa propre base de donn&eacute;es contenant une table <code class="code" id="-s7skff_57">products</code>.</p></li><li class="list__item" id="-s7skff_52"><p id="-s7skff_58"><span class="control" id="-s7skff_59">Technologie :</span> Spring Boot, Spring Web, Spring Data JPA, H2 (pour la simplicit&eacute; au d&eacute;but).</p></li></ul></li><li class="list__item" id="-s7skff_45"><p id="-s7skff_60"><span class="control" id="-s7skff_62"><code class="code" id="-s7skff_63">order-service</code> (Service Commande)</span></p><ul class="list _bullet" id="-s7skff_61"><li class="list__item" id="-s7skff_64"><p id="-s7skff_68"><span class="control" id="-s7skff_69">Responsabilit&eacute; :</span> Il g&egrave;re la cr&eacute;ation et la consultation des commandes. Une commande est essentiellement une liste de produits et une date.</p></li><li class="list__item" id="-s7skff_65"><p id="-s7skff_70"><span class="control" id="-s7skff_71">Interaction :</span> Pour cr&eacute;er une commande, il devra v&eacute;rifier que les produits demand&eacute;s existent et r&eacute;cup&eacute;rer leur prix. Pour cela, il devra <span class="control" id="-s7skff_72">communiquer avec <code class="code" id="-s7skff_73">product-service</code></span>.</p></li><li class="list__item" id="-s7skff_66"><p id="-s7skff_74"><span class="control" id="-s7skff_75">Base de donn&eacute;es :</span> Il aura sa propre base de donn&eacute;es avec des tables <code class="code" id="-s7skff_76">orders</code> et <code class="code" id="-s7skff_77">order_items</code>.</p></li><li class="list__item" id="-s7skff_67"><p id="-s7skff_78"><span class="control" id="-s7skff_79">Technologie :</span> Spring Boot, Spring Web, Spring Data JPA, H2.</p></li></ul></li></ol><p id="-s7skff_42">Voici notre plan d'architecture initial :</p><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="681px" preserveAspectRatio="none" style="width:932px;height:681px;background:#FFFFFF;" version="1.1" viewBox="0 0 932 681" width="932px" zoomAndPan="magnify"><defs/><g><!--cluster Ecosyst?me GestBook--><g id="cluster_Ecosyst&#232;me GestBook"><path d="M13.5,151.02 L185.5,151.02 A3.75,3.75 0 0 1 188,153.52 L195,174.0346 L902.5,174.0346 A2.5,2.5 0 0 1 905,176.5346 L905,671.56 A2.5,2.5 0 0 1 902.5,674.06 L13.5,674.06 A2.5,2.5 0 0 1 11,671.56 L11,153.52 A2.5,2.5 0 0 1 13.5,151.02 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="11" x2="195" y1="174.0346" y2="174.0346"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="171" x="15" y="167.0952">Ecosyst&#232;me GestBook</text></g><!--cluster ProductSvc--><g id="cluster_ProductSvc"><rect fill="#EEEEEE" height="241.03" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1.0;" width="408" x="465" y="401.03"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="175" x="581.5" y="417.1052">product-micro-service</text></g><!--cluster OrderSvc--><g id="cluster_OrderSvc"><rect fill="#EEEEEE" height="313.03" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1.0;" width="382" x="43" y="203.02"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="157" x="155.5" y="219.0952">order-micro-service</text></g><!--entity ProductController--><g id="elem_ProductController"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="162" x="489" y="445.03"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="631" y="450.03"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="629" y="452.03"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="629" y="456.03"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="122" x="504" y="479.1052">ProductController</text></g><!--entity ProductService--><g id="elem_ProductService"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="144" x="686" y="445.03"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="810" y="450.03"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="808" y="452.03"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="808" y="456.03"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104" x="701" y="479.1052">ProductService</text></g><!--entity ProductRepository--><g id="elem_ProductRepository"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="167" x="488.5" y="571.05"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="635.5" y="576.05"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="633.5" y="578.05"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="633.5" y="582.05"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="127" x="503.5" y="605.1252">ProductRepository</text></g><!--entity ProductDB--><g id="elem_ProductDB"><path d="M690,581.55 C690,571.55 740,571.55 740,571.55 C740,571.55 790,571.55 790,581.55 L790,607.5646 C790,617.5646 740,617.5646 740,617.5646 C740,617.5646 690,617.5646 690,607.5646 L690,581.55 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M690,581.55 C690,591.55 740,591.55 740,591.55 C740,591.55 790,591.55 790,581.55 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="80" x="700" y="609.6252">product DB</text></g><!--entity OrderController--><g id="elem_OrderController"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="149" x="66.5" y="247.02"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="195.5" y="252.02"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="193.5" y="254.02"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="193.5" y="258.02"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="109" x="81.5" y="281.0952">OrderController</text></g><!--entity OrderService--><g id="elem_OrderService"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="131" x="250.5" y="247.02"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="361.5" y="252.02"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="359.5" y="254.02"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="359.5" y="258.02"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="91" x="265.5" y="281.0952">OrderService</text></g><!--entity OrderRepository--><g id="elem_OrderRepository"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="154" x="67" y="445.03"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="201" y="450.03"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="199" y="452.03"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="199" y="456.03"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="114" x="82" y="479.1052">OrderRepository</text></g><!--entity OrderDB--><g id="elem_OrderDB"><path d="M256,455.53 C256,445.53 299,445.53 299,445.53 C299,445.53 342,445.53 342,455.53 L342,481.5446 C342,491.5446 299,491.5446 299,491.5446 C299,491.5446 256,491.5446 256,481.5446 L256,455.53 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M256,455.53 C256,465.53 299,465.53 299,465.53 C299,465.53 342,465.53 342,455.53 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="66" x="266" y="483.6052">Order DB</text></g><!--entity user--><g id="elem_user"><ellipse cx="625" cy="19" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1.0;"/><path d="M625,27 L625,54 M612,35 L638,35 M625,54 L612,69 M625,54 L638,69 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="72" x="589" y="85.0752">Utilisateur</text></g><!--link user to ProductSvc--><g id="link_user_ProductSvc"><path d="M659.47,88.39 C667.48,97.85 675.77,108.12 683,118.02 C765.03,230.28 795.25,255.58 846,385.03 C847.6637,389.2725 849.2031,393.6973 850.6238,398.1982 C850.8014,398.7608 850.9772,399.3246 851.1511,399.8893 C851.238,400.1717 849.5786,394.714 849.6646,394.9968 " fill="none" id="user-to-ProductSvc" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="851.4105,400.7372,852.6186,390.9627,849.9556,395.9535,844.9648,393.2906,851.4105,400.7372" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120" x="804.92" y="276.0898">GET /api/products</text></g><!--link user to OrderSvc--><g id="link_user_OrderSvc"><path d="M588.53,88.5 C559.17,119.485 517.1575,163.8225 482.06,200.8625 C464.5113,219.3825 448.6912,236.0781 437.0459,248.3681 C434.1346,251.4406 431.4842,254.2378 429.1329,256.7192 C427.9573,257.96 426.8564,259.1218 425.8351,260.1996 C425.5798,260.4691 429.4563,256.3779 429.211,256.6368 " fill="none" id="user-to-OrderSvc" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="425.0842,260.9922,434.178,257.2104,428.5232,257.3627,428.3708,251.7079,425.0842,260.9922" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="115" x="558.72" y="132.0898">POST /api/orders</text></g><!--link OrderSvc to ProductSvc--><g id="link_OrderSvc_ProductSvc"><path d="M425.1588,283.3042 C425.3286,283.5379 425.5009,283.7744 425.6756,284.0136 C426.0251,284.4921 426.3844,284.9816 426.7534,285.4817 C432.6575,293.4834 441.0438,304.1919 451.36,315.6238 C471.9925,338.4875 500.345,364.245 532,377.03 C548.18,383.57 832.49,373.99 846,385.03 C849.5288,387.9125 852.4816,391.3067 854.9462,395.0465 C856.1785,396.9163 854.6305,393.4936 855.6297,395.5154 " fill="none" id="OrderSvc-to-ProductSvc" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="858.2879,400.8945,857.8866,391.0538,856.0727,396.4119,850.7146,394.5981,858.2879,400.8945" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="256" x="541.5" y="338.0998">Donne-moi les infos du produit ID 123</text><path d="M537,346.8293 L537,371.8293 L802,371.8293 L802,356.8293 L792,346.8293 L537,346.8293 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M792,346.8293 L792,356.8293 L802,356.8293 L792,346.8293 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="244" x="543" y="364.8991">Communication inter-service (REST)</text></g><!--SRC=[VP6nRi8m54LtVyLhkhH3G2KR0qD8X3g129sg3gxpIgtOVf7j8A6A_-b_zCTgafGWGFNcUw-lZv_l_2TgX5fnQPYhfAcvvHei2i_DLY5yCGWh9LkYdPCY2_T9adGY5zNMKcFAtiZpd1tEMWJfcWmQN_Xzg6gqcZ36XG_PwCLB9HttsDW8k8F6eMMi3fLyYn3bWjpU-P_l0BT0vrEYAkfX1hYejbGsmiTQ2ajngDX9WMtVgdEAdUXF7TThhyx9U4jAeNsxyegkvDfOOqrE1lZzu9NSytVk1XB8qlFhixID7jWbU3lF6zZBetu1lUncVmEvIry1j_B_k6ta3xRTd503xF4p82xZU7O-noaiyWsCUIt7_MlTAJaRoAUmMXPzhdscO-naZaONbL56nc2iIO921z9ya8EoWVO6wU4vWwT94Z537e4CA6cgASn9wyP8mRqCcZG-3BCV8poiysBpo7u1]--></g></svg></div></section></section><section class="chapter"><h2 id="cr-ation-de-notre-premier-microservice-product-service" data-toc="cr-ation-de-notre-premier-microservice-product-service">Cr&eacute;ation de notre premier Microservice : <code class="code" id="-s7skff_85">product-service</code></h2><section class="procedure-steps" id="-s7skff_81"><p id="-s7skff_86">Nous allons commencer par cr&eacute;er le squelette du <code class="code" id="-s7skff_90">product-service</code>. Nous utiliserons le <a href="https://start.spring.io/" id="-s7skff_91" data-external="true" rel="noopener noreferrer" target="_blank">Spring Initializr</a>, l'outil incontournable pour d&eacute;marrer un projet Spring Boot.</p><p id="-s7skff_87"><b id="-s7skff_92">Configuration du projet sur start.spring.io :</b></p><ul class="list _bullet" id="-s7skff_88"><li class="list__item" id="-s7skff_93"><p><b id="-s7skff_98">Project :</b> Maven Project</p></li><li class="list__item" id="-s7skff_94"><p><b id="-s7skff_99">Language :</b> Java</p></li><li class="list__item" id="-s7skff_95"><p><b id="-s7skff_100">Spring Boot :</b> 3.2.x (ou une version stable r&eacute;cente)</p></li><li class="list__item" id="-s7skff_96"><p><b id="-s7skff_101">Project Metadata :</b></p><ul class="list _bullet" id="-s7skff_102"><li class="list__item" id="-s7skff_103"><p><b id="-s7skff_110">Group :</b> <code class="code" id="-s7skff_111">fr.formation.spring</code></p></li><li class="list__item" id="-s7skff_104"><p><b id="-s7skff_112">Artifact :</b> <code class="code" id="-s7skff_113">product-service</code></p></li><li class="list__item" id="-s7skff_105"><p><b id="-s7skff_114">Name :</b> <code class="code" id="-s7skff_115">product-service</code></p></li><li class="list__item" id="-s7skff_106"><p><b id="-s7skff_116">Description :</b> Service pour g&eacute;rer le catalogue de livres</p></li><li class="list__item" id="-s7skff_107"><p><b id="-s7skff_117">Package name :</b> <code class="code" id="-s7skff_118">fr.formation.spring.productservice</code></p></li><li class="list__item" id="-s7skff_108"><p><b id="-s7skff_119">Packaging :</b> Jar</p></li><li class="list__item" id="-s7skff_109"><p><b id="-s7skff_120">Java :</b> 17 (ou plus r&eacute;cent)</p></li></ul></li><li class="list__item" id="-s7skff_97"><p><b id="-s7skff_121">Dependencies :</b></p><ul class="list _bullet" id="-s7skff_122"><li class="list__item" id="-s7skff_123"><p><code class="code" id="-s7skff_127">Spring Web</code>: Pour cr&eacute;er des API REST.</p></li><li class="list__item" id="-s7skff_124"><p><code class="code" id="-s7skff_128">Spring Data JPA</code>: Pour interagir facilement avec la base de donn&eacute;es.</p></li><li class="list__item" id="-s7skff_125"><p><code class="code" id="-s7skff_129">H2 Database</code>: Une base de donn&eacute;es en m&eacute;moire, parfaite pour le d&eacute;veloppement.</p></li><li class="list__item" id="-s7skff_126"><p><code class="code" id="-s7skff_130">Lombok</code>: Pour r&eacute;duire le code &quot;boilerplate&quot; (getters, setters, etc.).</p></li></ul></li></ul><p id="-s7skff_89">Cliquez sur &quot;GENERATE&quot;, t&eacute;l&eacute;chargez le .zip, et ouvrez le projet dans votre IDE pr&eacute;f&eacute;r&eacute; (IntelliJ IDEA, VS Code, Eclipse...).</p><ol class="list _decimal"></ol></section><section class="chapter"><h3 id="structure-du-projet" data-toc="structure-du-projet">Structure du projet</h3><p id="-s7skff_131">Une fois le projet ouvert, vous aurez une structure classique de projet Spring Boot :</p><div class="code-block" data-lang="none">
product-service/
├── pom.xml                 # Le fichier de configuration Maven
└── src/
    └── main/
        ├── java/
        │   └── fr/
        │       └── formation/
        │           └── spring/
        │               └── productservice/
        │                   └── ProductServiceApplication.java
        └── resources/
            └── application.properties # Le fichier de configuration
</div></section><section class="chapter"><h3 id="fichier-pom-xml" data-toc="fichier-pom-xml">Fichier <code class="code" id="-s7skff_136">pom.xml</code></h3><p id="-s7skff_134">Le <code class="code" id="-s7skff_137">pom.xml</code> g&eacute;n&eacute;r&eacute; contient toutes les d&eacute;pendances que nous avons demand&eacute;es. Voici un extrait des d&eacute;pendances cl&eacute;s :</p><div class="code-block" data-lang="markup">
&lt;!-- pom.xml --&gt;
&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
        &lt;groupId&gt;com.h2database&lt;/groupId&gt;
        &lt;artifactId&gt;h2&lt;/artifactId&gt;
        &lt;scope&gt;runtime&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
        &lt;artifactId&gt;lombok&lt;/artifactId&gt;
        &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</div></section><section class="chapter"><h3 id="configuration-de-l-application" data-toc="configuration-de-l-application">Configuration de l'application</h3><p id="-s7skff_138">Configurons notre service pour qu'il soit identifiable.</p><p id="-s7skff_139">Dans <code class="code" id="-s7skff_142">src/main/resources/application.properties</code>, ajoutez les lignes suivantes :</p><div class="code-block" data-lang="properties">
# Indique le port sur lequel le serveur va démarrer.
# On choisit un port différent pour chaque service pour éviter les conflits.
server.port=8081

# Le nom de notre application. Très important pour la suite !

spring.application.name=product-service

# Configuration de la base de données H2

# Activer la console web de H2 pour visualiser nos données

spring.h2.console.enabled=true

# Définir le chemin d'accès à la console

spring.h2.console.path=/h2-console

# Configuration de la source de données JPA

spring.datasource.url=jdbc:h2:mem:productdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=update

</div><aside class="prompt" data-type="tip" data-title="" id="-s7skff_141"><p id="-s7skff_143"><span class="control" id="-s7skff_144">Conseil :</span> Utiliser des ports diff&eacute;rents pour chaque microservice (8081, 8082, etc.) est une pratique courante en d&eacute;veloppement local pour pouvoir les lancer tous en m&ecirc;me temps sur votre machine.</p></aside></section></section><section class="chapter"><h2 id="impl-mentation-de-la-logique-m-tier" data-toc="impl-mentation-de-la-logique-m-tier">Impl&eacute;mentation de la logique m&eacute;tier</h2><p id="-s7skff_145">Maintenant, ajoutons le code pour g&eacute;rer nos produits.</p><section class="chapter"><h3 id="1-l-entit-product" data-toc="1-l-entit-product">1. L'Entit&eacute; <code class="code" id="-s7skff_152">Product</code></h3><p id="-s7skff_150">C'est la repr&eacute;sentation de notre table <code class="code" id="-s7skff_153">products</code> en Java.</p><div class="code-block" data-lang="java">
// package fr.formation.spring.productservice.entity;

import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import lombok.Data;
import lombok.NoArgsConstructor;
import lombok.AllArgsConstructor;

@Entity     // Indique que cette classe est une entité JPA
@Data       // Lombok : génère getters, setters, toString, etc.
@NoArgsConstructor
@AllArgsConstructor
@Table(name = &quot;products&quot;)
public class Product {

    @Id // Clé primaire
    @GeneratedValue(strategy = GenerationType.IDENTITY) // Auto-incrément
    private Long id;

    private String name;    // Nom du livre
    private String author;  // Auteur du livre
    private String isbn;    // ISBN du livre
    private double price;   // Prix du livre
    private int stock;      // Quantité en stock
}
</div></section><section class="chapter"><h3 id="2-le-productrepository" data-toc="2-le-productrepository">2. Le <code class="code" id="-s7skff_157">ProductRepository</code></h3><p id="-s7skff_155">C'est une interface qui nous permettra de faire des op&eacute;rations CRUD sur nos produits sans &eacute;crire une seule ligne de SQL. C'est la magie de Spring Data JPA !</p><div class="code-block" data-lang="java">
// package fr.formation.spring.productservice.repository;

import fr.formation.spring.productservice.entity.Product;
import org.springframework.data.jpa.repository.JpaRepository;

// On étend JpaRepository en spécifiant l'entité (Product)
// et le type de sa clé primaire (Long).
public interface ProductRepository extends JpaRepository&lt;Product, Long&gt; {
    // Spring Data JPA va automatiquement implémenter les méthodes
    // comme findAll(), findById(), save(), deleteById(), etc.
}
</div></section><section class="chapter"><h3 id="3-le-productcontroller" data-toc="3-le-productcontroller">3. Le <code class="code" id="-s7skff_163">ProductController</code></h3><p id="-s7skff_159">C'est notre porte d'entr&eacute;e. Il expose les points d'acc&egrave;s (endpoints) de notre API REST.</p><div class="code-block" data-lang="java">
// package fr.formation.spring.productservice.controller;

import fr.formation.spring.productservice.entity.Product;
import fr.formation.spring.productservice.repository.ProductRepository;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;
import java.util.Optional;

@RestController // Indique que c'est un contrôleur REST
@RequestMapping(&quot;/api/products&quot;) // Préfixe pour tous les endpoints de cette classe
public class ProductController {

    // Injection de dépendance de notre repository
    private final ProductRepository productRepository;

    public ProductController(ProductRepository productRepository) {
        this.productRepository = productRepository;
    }

    // Endpoint pour récupérer tous les produits
    // GET http://localhost:8081/api/products
    @GetMapping
    public List&lt;Product&gt; getAllProducts() {
        return productRepository.findAll();
    }

    // Endpoint pour récupérer un produit par son ID
    // GET http://localhost:8081/api/products/1
    @GetMapping(&quot;/{id}&quot;)
    public ResponseEntity&lt;Product&gt; getProductById(@PathVariable Long id) {
        Optional&lt;Product&gt; product = productRepository.findById(id);
        // On retourne le produit avec un statut 200 OK,
        // ou un statut 404 Not Found s'il n'existe pas.
        return product.map(ResponseEntity::ok)
                .orElseGet(() -&gt; ResponseEntity.notFound().build());
    }
}
</div><p id="-s7skff_161">Diagramme de classes simplifi&eacute; pour <code class="code" id="-s7skff_164">product-service</code>:</p><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="779px" preserveAspectRatio="none" style="width:929px;height:779px;background:#FFFFFF;" version="1.1" viewBox="0 0 929 779" width="929px" zoomAndPan="magnify"><defs/><g><!--cluster fr--><g id="cluster_fr"><path d="M13.5,11 L27.5,11 A3.75,3.75 0 0 1 30,13.5 L37,34.0146 L630.5,34.0146 A2.5,2.5 0 0 1 633,36.5146 L633,769.63 A2.5,2.5 0 0 1 630.5,772.13 L13.5,772.13 A2.5,2.5 0 0 1 11,769.63 L11,13.5 A2.5,2.5 0 0 1 13.5,11 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="11" x2="37" y1="34.0146" y2="34.0146"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="13" x="15" y="27.0752">fr</text></g><!--cluster formation--><g id="cluster_formation"><path d="M37.5,55 L116.5,55 A3.75,3.75 0 0 1 119,57.5 L126,78.0146 L606.5,78.0146 A2.5,2.5 0 0 1 609,80.5146 L609,745.63 A2.5,2.5 0 0 1 606.5,748.13 L37.5,748.13 A2.5,2.5 0 0 1 35,745.63 L35,57.5 A2.5,2.5 0 0 1 37.5,55 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="35" x2="126" y1="78.0146" y2="78.0146"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="39" y="71.0752">formation</text></g><!--cluster spring--><g id="cluster_spring"><path d="M61.5,99 L112.5,99 A3.75,3.75 0 0 1 115,101.5 L122,122.0146 L582.5,122.0146 A2.5,2.5 0 0 1 585,124.5146 L585,721.63 A2.5,2.5 0 0 1 582.5,724.13 L61.5,724.13 A2.5,2.5 0 0 1 59,721.63 L59,101.5 A2.5,2.5 0 0 1 61.5,99 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="59" x2="122" y1="122.0146" y2="122.0146"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="50" x="63" y="115.0752">spring</text></g><!--cluster productservice--><g id="cluster_productservice"><path d="M85.5,143 L202.5,143 A3.75,3.75 0 0 1 205,145.5 L212,166.0146 L558.5,166.0146 A2.5,2.5 0 0 1 561,168.5146 L561,697.63 A2.5,2.5 0 0 1 558.5,700.13 L85.5,700.13 A2.5,2.5 0 0 1 83,697.63 L83,145.5 A2.5,2.5 0 0 1 85.5,143 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="83" x2="212" y1="166.0146" y2="166.0146"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="116" x="87" y="159.0752">productservice</text></g><!--cluster controller--><g id="cluster_controller"><path d="M109.5,187 L187.5,187 A3.75,3.75 0 0 1 190,189.5 L197,210.0146 L534.5,210.0146 A2.5,2.5 0 0 1 537,212.5146 L537,331.54 A2.5,2.5 0 0 1 534.5,334.04 L109.5,334.04 A2.5,2.5 0 0 1 107,331.54 L107,189.5 A2.5,2.5 0 0 1 109.5,187 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="107" x2="197" y1="210.0146" y2="210.0146"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="77" x="111" y="203.0752">controller</text></g><!--cluster repository--><g id="cluster_repository"><path d="M230.5,358.04 L312.5,358.04 A3.75,3.75 0 0 1 315,360.54 L322,381.0546 L413.5,381.0546 A2.5,2.5 0 0 1 416,383.5546 L416,468.56 A2.5,2.5 0 0 1 413.5,471.06 L230.5,471.06 A2.5,2.5 0 0 1 228,468.56 L228,360.54 A2.5,2.5 0 0 1 230.5,358.04 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="228" x2="322" y1="381.0546" y2="381.0546"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="81" x="232" y="374.1152">repository</text></g><!--cluster entity--><g id="cluster_entity"><path d="M246.5,495.06 L292.5,495.06 A3.75,3.75 0 0 1 295,497.56 L302,518.0746 L397.5,518.0746 A2.5,2.5 0 0 1 400,520.5746 L400,673.63 A2.5,2.5 0 0 1 397.5,676.13 L246.5,676.13 A2.5,2.5 0 0 1 244,673.63 L244,497.56 A2.5,2.5 0 0 1 246.5,495.06 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="244" x2="302" y1="518.0746" y2="518.0746"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="45" x="248" y="511.1352">entity</text></g><!--class ProductController--><g id="elem_ProductController"><rect codeLine="5" fill="#FFFFFF" height="95.0439" id="ProductController" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="397" x="123.5" y="223"/><ellipse cx="257.25" cy="237" fill="#FFFFFF" rx="9" ry="9" style="stroke:#000000;stroke-width:1.0;"/><path d="M260.2231,242.6431 Q259.6421,242.9419 259.0029,243.0913 Q258.3638,243.2407 257.6582,243.2407 Q255.1514,243.2407 253.8315,241.5889 Q252.5117,239.937 252.5117,236.8159 Q252.5117,233.6865 253.8315,232.0347 Q255.1514,230.3828 257.6582,230.3828 Q258.3638,230.3828 259.0112,230.5322 Q259.6587,230.6816 260.2231,230.9805 L260.2231,233.7031 Q259.5923,233.1221 258.9988,232.8523 Q258.4053,232.5825 257.7744,232.5825 Q256.4297,232.5825 255.7449,233.6492 Q255.0601,234.7158 255.0601,236.8159 Q255.0601,238.9077 255.7449,239.9744 Q256.4297,241.041 257.7744,241.041 Q258.4053,241.041 258.9988,240.7712 Q259.5923,240.5015 260.2231,239.9204 Z " fill="#000000"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="122" x="274.75" y="242.5679">ProductController</text><line style="stroke:#000000;stroke-width:1.0;" x1="124.5" x2="519.5" y1="251" y2="251"/><rect fill="none" height="6" style="stroke:#000000;stroke-width:1.0;" width="6" x="131.5" y="262.0073"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="266" x="141.5" y="269.0752">productRepository: ProductRepository</text><line style="stroke:#000000;stroke-width:1.0;" x1="124.5" x2="519.5" y1="276.0146" y2="276.0146"/><ellipse cx="134.5" cy="290.022" fill="#FFFFFF" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="224" x="141.5" y="294.0898">getAllProducts(): List&lt;Product&gt;</text><ellipse cx="134.5" cy="307.0366" fill="#FFFFFF" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="373" x="141.5" y="311.1045">getProductById(id: Long): ResponseEntity&lt;Product&gt;</text></g><!--class ProductRepository--><g id="elem_ProductRepository"><rect codeLine="13" fill="#FFFFFF" height="61.0146" id="ProductRepository" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="155" x="244.5" y="394.04"/><ellipse cx="257.5" cy="408.04" fill="#FFFFFF" rx="9" ry="9" style="stroke:#000000;stroke-width:1.0;"/><path d="M253.4277,403.8051 L253.4277,401.6469 L260.8071,401.6469 L260.8071,403.8051 L258.3418,403.8051 L258.3418,411.8818 L260.8071,411.8818 L260.8071,414.04 L253.4277,414.04 L253.4277,411.8818 L255.8931,411.8818 L255.8931,403.8051 Z " fill="#000000"/><text fill="#000000" font-family="Verdana" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="127" x="269.5" y="413.6079">ProductRepository</text><line style="stroke:#000000;stroke-width:1.0;" x1="245.5" x2="398.5" y1="422.04" y2="422.04"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="115" x="250.5" y="440.1152">&#171;JpaRepository&#187;</text><line style="stroke:#000000;stroke-width:1.0;" x1="245.5" x2="398.5" y1="447.0546" y2="447.0546"/></g><!--class Product--><g id="elem_Product"><rect codeLine="19" fill="#FFFFFF" height="129.0732" id="Product" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="125" x="259.5" y="531.06"/><ellipse cx="292.3" cy="545.06" fill="#FFFFFF" rx="9" ry="9" style="stroke:#000000;stroke-width:1.0;"/><path d="M295.2731,550.7031 Q294.6921,551.0019 294.0529,551.1513 Q293.4138,551.3007 292.7082,551.3007 Q290.2014,551.3007 288.8815,549.6489 Q287.5617,547.997 287.5617,544.8759 Q287.5617,541.7465 288.8815,540.0947 Q290.2014,538.4428 292.7082,538.4428 Q293.4138,538.4428 294.0612,538.5922 Q294.7087,538.7416 295.2731,539.0405 L295.2731,541.7631 Q294.6423,541.1821 294.0488,540.9123 Q293.4553,540.6425 292.8244,540.6425 Q291.4797,540.6425 290.7949,541.7092 Q290.1101,542.7758 290.1101,544.8759 Q290.1101,546.9677 290.7949,548.0344 Q291.4797,549.101 292.8244,549.101 Q293.4553,549.101 294.0488,548.8312 Q294.6423,548.5615 295.2731,547.9804 Z " fill="#000000"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="53" x="308.7" y="550.6279">Product</text><line style="stroke:#000000;stroke-width:1.0;" x1="260.5" x2="383.5" y1="559.06" y2="559.06"/><rect fill="none" height="6" style="stroke:#000000;stroke-width:1.0;" width="6" x="267.5" y="570.0673"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="58" x="277.5" y="577.1352">id: Long</text><rect fill="none" height="6" style="stroke:#000000;stroke-width:1.0;" width="6" x="267.5" y="587.082"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="94" x="277.5" y="594.1498">name: String</text><rect fill="none" height="6" style="stroke:#000000;stroke-width:1.0;" width="6" x="267.5" y="604.0966"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="101" x="277.5" y="611.1645">author: String</text><rect fill="none" height="6" style="stroke:#000000;stroke-width:1.0;" width="6" x="267.5" y="621.1113"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="92" x="277.5" y="628.1791">price: double</text><rect fill="none" height="6" style="stroke:#000000;stroke-width:1.0;" width="6" x="267.5" y="638.1259"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="66" x="277.5" y="645.1938">stock: int</text><line style="stroke:#000000;stroke-width:1.0;" x1="260.5" x2="383.5" y1="652.1332" y2="652.1332"/></g><g id="elem_N1"><path d="M649.5,403.75 L649.5,445.3486 A0,0 0 0 0 649.5,445.3486 L922.5,445.3486 A0,0 0 0 0 922.5,445.3486 L922.5,413.75 L912.5,403.75 L728.15,403.75 L465.32,318.48 L720.15,403.75 L649.5,403.75 A0,0 0 0 0 649.5,403.75 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M912.5,403.75 L912.5,413.75 L922.5,413.75 L912.5,403.75 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="224" x="655.5" y="421.8198">Le Controller utilise le Repository</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="252" x="655.5" y="437.6191">pour acc&#233;der aux donn&#233;es de l'Entit&#233;.</text></g><!--link ProductController to ProductRepository--><g id="link_ProductController_ProductRepository"><path codeLine="29" d="M322,318.37 C322,342.98 322,366.38 322,387.84 " fill="none" id="ProductController-to-ProductRepository" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="322,393.84,326,384.84,322,388.84,318,384.84,322,393.84" style="stroke:#000000;stroke-width:1.0;"/></g><!--link ProductRepository to Product--><g id="link_ProductRepository_Product"><path codeLine="30" d="M322,455.38 C322,476.23 322,498.87 322,524.75 " fill="none" id="ProductRepository-to-Product" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="322,530.75,326,521.75,322,525.75,318,521.75,322,530.75" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="60" x="256.0938" y="476.0753">manages</text></g><!--SRC=[XL91JiCm4Bpd5Kik5A56uXfLbG1n05K8bIiNusnIgyxQiZU82l6WlgCVmsdJDerRiOSSTcRMCxkvuWNM25OBHOaLSYagXBHqMMbSBLWPohnrYghCEbCqaZswBoKnXPy4GXqaqX0xepMwFTIMrC9xUDj97m-K7gEjCNJ3vsYDLspSAj-BZgqJoIrKoFTQTom_kibXfZnFkiOqPdV8m-gv6AaYq0rLGJL7RmrvV29Ml8hrlydkUnhN7MpruofYTAMG6BiVH9vCNgmuejF_tiEjkukhZHQw3pXeawWnXtTkBpg0HCCBuow0uHUGGLYOvbFZ0FDiv39liqSPGehuzkFnzCnnuuMbjQ2GtQTzHPAGuR2F6K9lPCDAAu-W4Ou3FiYQne6GShCk0aaqto40qMQD7ef0ljwUVBFEKX0UNk_EUCsoqFy3]--></g></svg></div></section></section><section class="chapter"><h2 id="hydrater-la-base-de-donn-es-pour-les-tests" data-toc="hydrater-la-base-de-donn-es-pour-les-tests">Hydrater la base de donn&eacute;es pour les tests</h2><p id="-s7skff_165">Pour ne pas avoir une API qui renvoie une liste vide au d&eacute;marrage, nous allons ins&eacute;rer quelques donn&eacute;es de test.</p><section class="procedure-steps" id="-s7skff_166"><p id="-s7skff_169">Cr&eacute;ez un fichier <code class="code" id="-s7skff_170">src/main/resources/import.sql</code>. Spring Boot ex&eacute;cutera automatiquement ce script au d&eacute;marrage contre notre base H2.</p><ol class="list _decimal"></ol></section><div class="code-block" data-lang="sql">
-- src/main/resources/import.sql

INSERT INTO products (name, author, isbn, price, stock) VALUES ('L\'Étranger', 'Albert Camus', '978-2070360024', 6.50, 85);
INSERT INTO products (name, author, isbn, price, stock) VALUES ('Dune, Tome 1', 'Frank Herbert', '978-2266223299', 11.90, 65);
INSERT INTO products (name, author, isbn, price, stock) VALUES ('Clean Code', 'Robert C. Martin', '978-0132350884', 35.50, 90);
INSERT INTO products (name, author, isbn, price, stock) VALUES ('Harry Potter à l''école des sorciers', 'J.K. Rowling', '978-2070643028', 8.70, 250);
INSERT INTO products (name, author, isbn, price, stock) VALUES ('Le Petit Prince', 'Antoine de Saint-Exupéry', '978-2070612758', 8.90, 120);
</div><aside class="prompt" data-type="warning" data-title="" id="-s7skff_168"><p>Attention ! <br> Dans la derni&egrave;re version de Spring, il est crucial de nommer le fichier de fixtures <code class="code" id="-s7skff_172">import.sql</code> et non <code class="code" id="-s7skff_173">data.sql</code>. En effet, avec ce dernier nom Spring tentera de charger les donn&eacute;es avant que JPA ait g&eacute;n&eacute;r&eacute; le sch&eacute;ma.</p></aside></section><section class="chapter"><h2 id="lancement-et-validation" data-toc="lancement-et-validation">Lancement et validation</h2><ol class="list _decimal" id="-s7skff_174" type="1"><li class="list__item" id="-s7skff_179"><p id="-s7skff_182">Lancez l'application en ex&eacute;cutant la m&eacute;thode <code class="code" id="-s7skff_183">main</code> de la classe <code class="code" id="-s7skff_184">ProductServiceApplication.java</code>.</p></li><li class="list__item" id="-s7skff_180"><p id="-s7skff_185">Ouvrez votre navigateur ou un client API (Postman, Insomnia, ou le client HTTP d'IntelliJ).</p></li><li class="list__item" id="-s7skff_181"><p id="-s7skff_186">Faites un appel <code class="code" id="-s7skff_187">GET</code> &agrave; <code class="code" id="-s7skff_188">http://localhost:8081/api/products</code>.</p></li></ol><p id="-s7skff_175">Vous devriez recevoir une r&eacute;ponse JSON avec la liste des 3 livres que nous avons ins&eacute;r&eacute;s !</p><p id="-s7skff_176">Requ&ecirc;te HTTP pour IntelliJ :</p><div class="code-block" data-lang="http">
### Get all products
GET http://localhost:8081/api/products
Accept: application/json
</div></section><section class="chapter"><h2 id="exercice-3-ajouter-un-endpoint-de-cr-ation" data-toc="exercice-3-ajouter-un-endpoint-de-cr-ation">Exercice 3 : Ajouter un endpoint de cr&eacute;ation</h2><p id="-s7skff_189"><span class="control" id="-s7skff_193">Contexte :</span> Notre <code class="code" id="-s7skff_194">product-service</code> peut lister et lire des produits. Il nous manque une fonctionnalit&eacute; essentielle : en ajouter de nouveaux.</p><p id="-s7skff_190"><span class="control" id="-s7skff_195">Votre mission :</span></p><ol class="list _decimal" id="-s7skff_191" type="1"><li class="list__item" id="-s7skff_196"><p id="-s7skff_201">Dans <code class="code" id="-s7skff_202">ProductController</code>, ajoutez une m&eacute;thode pour g&eacute;rer la cr&eacute;ation d'un nouveau produit.</p></li><li class="list__item" id="-s7skff_197"><p id="-s7skff_203">L'endpoint doit r&eacute;pondre &agrave; une requ&ecirc;te <code class="code" id="-s7skff_204">POST</code> sur <code class="code" id="-s7skff_205">/api/products</code>.</p></li><li class="list__item" id="-s7skff_198"><p id="-s7skff_206">Le corps de la requ&ecirc;te contiendra le JSON du produit &agrave; cr&eacute;er (sans l'ID).</p></li><li class="list__item" id="-s7skff_199"><p id="-s7skff_207">La m&eacute;thode doit utiliser <code class="code" id="-s7skff_208">productRepository.save()</code> pour persister le nouveau produit.</p></li><li class="list__item" id="-s7skff_200"><p id="-s7skff_209">La r&eacute;ponse doit &ecirc;tre le produit nouvellement cr&eacute;&eacute; (avec son ID g&eacute;n&eacute;r&eacute;) et un statut HTTP <code class="code" id="-s7skff_210">201 Created</code>.</p></li></ol><section class="chapter"><div class="collapse"><div class="collapse__title"><h3 id="correction-exercice-3" data-toc="correction-exercice-3">Correction exercice 3</h3></div><div class="collapse__content"><p id="-s7skff_211">Voici l'impl&eacute;mentation de la m&eacute;thode &agrave; ajouter dans la classe <code class="code" id="-s7skff_217">ProductController</code>.</p><div class="code-block" data-lang="java">
// Dans la classe fr.formation.spring.productservice.controller.ProductController

// ... (imports et code existant)

import org.springframework.http.HttpStatus;
// ...

// ... (méthodes GET existantes)

// Endpoint pour créer un nouveau produit

// POST http://localhost:8081/api/products
@PostMapping
@ResponseStatus(HttpStatus.CREATED) // Définit le code de statut HTTP à 201
public Product createProduct(@RequestBody Product product) {
    // @RequestBody indique à Spring de convertir le JSON
    // du corps de la requête en un objet Product.
    // L'ID du produit entrant sera null.
    // La méthode save() renvoie l'entité persistée,
    // qui inclut maintenant l'ID généré par la base de données.
    return productRepository.save(product);
}
</div><p id="-s7skff_213"><span class="control" id="-s7skff_218">Test avec le client HTTP d'IntelliJ :</span></p><div class="code-block" data-lang="http">
### Create a new product
POST http://localhost:8081/api/products
Content-Type: application/json

{
  &quot;name&quot;: &quot;Le Mythe de Sisyphe&quot;,
  &quot;author&quot;: &quot;Albert Camus&quot;,
  &quot;isbn&quot;: &quot;978-2070322886&quot;,
  &quot;price&quot;: 7.60,
  &quot;stock&quot;: 25
}
</div><p id="-s7skff_215">Apr&egrave;s avoir ex&eacute;cut&eacute; cette requ&ecirc;te, si vous refaites un <code class="code" id="-s7skff_219">GET</code> sur <code class="code" id="-s7skff_220">/api/products</code>, vous verrez le nouveau livre ajout&eacute; &agrave; la liste.</p></div></div></section></section><section class="chapter"><h2 id="auto-valuation" data-toc="auto-valuation">Auto-&eacute;valuation</h2><p id="-s7skff_221">Prenez un moment pour r&eacute;pondre &agrave; ces questions. Les corrections se trouvent &agrave; la toute fin du support de cours.</p><ol class="list _decimal" id="-s7skff_222" type="1"><li class="list__item" id="-s7skff_224"><p id="-s7skff_229"><span class="control" id="-s7skff_231">(QCM)</span> Quelle d&eacute;pendance Maven est indispensable pour cr&eacute;er des endpoints REST avec Spring Boot ?</p><ul class="list _bullet" id="-s7skff_230"><li class="list__item" id="-s7skff_232"><p id="-s7skff_236">A) <code class="code" id="-s7skff_237">spring-boot-starter-data-jpa</code></p></li><li class="list__item" id="-s7skff_233"><p id="-s7skff_238">B) <code class="code" id="-s7skff_239">spring-boot-starter-web</code></p></li><li class="list__item" id="-s7skff_234"><p id="-s7skff_240">C) <code class="code" id="-s7skff_241">h2</code></p></li><li class="list__item" id="-s7skff_235"><p id="-s7skff_242">D) <code class="code" id="-s7skff_243">lombok</code></p></li></ul></li><li class="list__item" id="-s7skff_225"><p id="-s7skff_244"><span class="control" id="-s7skff_245">(Question ouverte)</span> Quel est le r&ocirc;le de l'annotation <code class="code" id="-s7skff_246">@RestController</code>? Quelle est la diff&eacute;rence avec <code class="code" id="-s7skff_247">@Controller</code>?</p></li><li class="list__item" id="-s7skff_226"><p id="-s7skff_248"><span class="control" id="-s7skff_250">(QCM)</span> Dans notre <code class="code" id="-s7skff_251">application.properties</code>, &agrave; quoi sert la ligne <code class="code" id="-s7skff_252">server.port=8081</code>?</p><ul class="list _bullet" id="-s7skff_249"><li class="list__item" id="-s7skff_253"><p id="-s7skff_257">A) &Agrave; nommer l'application.</p></li><li class="list__item" id="-s7skff_254"><p id="-s7skff_258">B) &Agrave; d&eacute;finir la version de Java &agrave; utiliser.</p></li><li class="list__item" id="-s7skff_255"><p id="-s7skff_259">C) &Agrave; sp&eacute;cifier le port d'&eacute;coute du serveur web embarqu&eacute;.</p></li><li class="list__item" id="-s7skff_256"><p id="-s7skff_260">D) &Agrave; activer la console H2.</p></li></ul></li><li class="list__item" id="-s7skff_227"><p id="-s7skff_261"><span class="control" id="-s7skff_262">(Question ouverte)</span> Expliquez ce que fait la ligne <code class="code" id="-s7skff_263">public interface ProductRepository extends JpaRepository&lt;Product, Long&gt;</code>. Pourquoi n'avons-nous pas besoin d'&eacute;crire de code dans cette interface pour que <code class="code" id="-s7skff_264">findById</code> fonctionne ?</p></li><li class="list__item" id="-s7skff_228"><p id="-s7skff_265"><span class="control" id="-s7skff_267">(QCM)</span> Pour tester notre nouvel endpoint de cr&eacute;ation, quelle m&eacute;thode HTTP et quel code de statut de succ&egrave;s sont attendus ?</p><ul class="list _bullet" id="-s7skff_266"><li class="list__item" id="-s7skff_268"><p id="-s7skff_272">A) GET, 200 OK</p></li><li class="list__item" id="-s7skff_269"><p id="-s7skff_273">B) POST, 201 Created</p></li><li class="list__item" id="-s7skff_270"><p id="-s7skff_274">C) PUT, 200 OK</p></li><li class="list__item" id="-s7skff_271"><p id="-s7skff_275">D) POST, 200 OK</p></li></ul></li></ol></section><section class="chapter"><h2 id="conclusion" data-toc="conclusion">Conclusion</h2><p id="-s7skff_276">F&eacute;licitations, vous avez franchi une &eacute;tape majeure ! Vous ne vous &ecirc;tes pas content&eacute; de lire la th&eacute;orie, vous avez * <span class="emphasis" id="-s7skff_279">construit votre premier microservice</span>*. Vous avez cr&eacute;&eacute; un projet Spring Boot de A &agrave; Z, configur&eacute; une base de donn&eacute;es en m&eacute;moire, d&eacute;fini une entit&eacute; JPA, expos&eacute; une API REST et m&ecirc;me ins&eacute;r&eacute; des donn&eacute;es de test.</p><p id="-s7skff_277">Ce <code class="code" id="-s7skff_280">product-service</code> est la premi&egrave;re brique de notre architecture &quot;GestBook&quot;. Il est simple, mais fonctionnel et autonome.</p><p id="-s7skff_278">Cependant, un microservice seul n'a que peu d'int&eacute;r&ecirc;t. Sa puissance vient de sa capacit&eacute; &agrave; interagir avec d'autres. Mais avant de construire notre deuxi&egrave;me service et de les faire communiquer, nous allons nous attaquer &agrave; un probl&egrave;me fondamental du monde moderne : comment &quot;packager&quot; et ex&eacute;cuter notre service de mani&egrave;re fiable et reproductible n'importe o&ugrave; ? La r&eacute;ponse est <span class="control" id="-s7skff_281">Docker</span>. Dans le prochain TP, nous allons mettre notre <code class="code" id="-s7skff_282">product-service</code> en conteneur.</p></section><div class="last-modified">23 juillet 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="001-01-spring-cloud.html" class="navigation-links__prev">Module 1 : Avantages, D&eacute;fis et notre Alli&eacute; Spring Cloud (Pour aller plus loin)</a><a href="002-01-tp-1.html" class="navigation-links__next">TP 1 : Mettre notre service en bo&icirc;te : la Dockerisation</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>