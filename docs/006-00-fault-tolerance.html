<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-08-01T06:31:07.449041"><title>Module 6 : R&eacute;silience et Tol&eacute;rance aux Pannes - L'Art de ne pas s'effondrer (L'essentiel) | Spring Micro Services</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs Pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction-l-effet-domino","level":0,"title":"Introduction : L\u0027effet Domino","anchor":"#introduction-l-effet-domino"},{"id":"le-pattern-circuit-breaker-disjoncteur","level":0,"title":"Le Pattern Circuit Breaker (Disjoncteur)","anchor":"#le-pattern-circuit-breaker-disjoncteur"},{"id":"le-concept-de-fallback-m-thode-de-repli","level":0,"title":"Le Concept de \"Fallback\" (Méthode de Repli)","anchor":"#le-concept-de-fallback-m-thode-de-repli"},{"id":"notre-outil-resilience4j","level":0,"title":"Notre Outil : Resilience4j","anchor":"#notre-outil-resilience4j"},{"id":"conclusion-de-la-partie","level":0,"title":"Conclusion de la partie","anchor":"#conclusion-de-la-partie"},{"id":"auto-valuation","level":0,"title":"Auto-évaluation","anchor":"#auto-valuation"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Module 6 : R&eacute;silience et Tol&eacute;rance aux Pannes - L'Art de ne pas s'effondrer (L'essentiel) | Spring Micro Services"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Spring Micro Services Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/006-00-fault-tolerance.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Module 6 : R&eacute;silience et Tol&eacute;rance aux Pannes - L'Art de ne pas s'effondrer (L'essentiel) | Spring Micro Services"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/006-00-fault-tolerance.html#webpage",
    "url": "writerside-documentation/006-00-fault-tolerance.html",
    "name": "Module 6 : R&eacute;silience et Tol&eacute;rance aux Pannes - L'Art de ne pas s'effondrer (L'essentiel) | Spring Micro Services",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Spring Micro Services Help"
}</script><!-- End Schema.org --></head><body data-id="006-00-fault-tolerance" data-main-title="Module 6 : Résilience et Tolérance aux Pannes - L'Art de ne pas s'effondrer (L'essentiel)" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Spring Micro Services  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="006-00-fault-tolerance" id="006-00-fault-tolerance.md">Module 6 : Résilience et Tolérance aux Pannes - L'Art de ne pas s'effondrer (L'essentiel)</h1><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs P&eacute;dagogiques</h2><p id="fi5dut_10">&Agrave; la fin de cette partie, vous serez capable de :</p><ul class="list _bullet" id="fi5dut_11"><li class="list__item" id="fi5dut_12"><p id="fi5dut_16">Expliquer le ph&eacute;nom&egrave;ne de pannes en cascade dans un syst&egrave;me distribu&eacute;.</p></li><li class="list__item" id="fi5dut_13"><p id="fi5dut_17">D&eacute;crire le pattern &quot;Circuit Breaker&quot; (Disjoncteur) et ses trois &eacute;tats : Ferm&eacute;, Ouvert, Semi-ouvert.</p></li><li class="list__item" id="fi5dut_14"><p id="fi5dut_18">D&eacute;finir le concept de &quot;Fallback&quot; (m&eacute;thode de repli).</p></li><li class="list__item" id="fi5dut_15"><p id="fi5dut_19">Pr&eacute;senter Resilience4j comme la solution moderne pour impl&eacute;menter ce pattern.</p></li></ul></section><section class="chapter"><h2 id="introduction-l-effet-domino" data-toc="introduction-l-effet-domino">Introduction : L'effet Domino</h2><p id="fi5dut_20">Imaginez une cha&icirc;ne de montage complexe pour construire une voiture. La station A monte le ch&acirc;ssis, la station B y fixe les roues, la station C installe le moteur, et ainsi de suite. Tout fonctionne &agrave; merveille, jusqu'au jour o&ugrave; la machine de la station B, qui fixe les roues, tombe en panne.</p><p id="fi5dut_21">Que se passe-t-il ? La station A continue de produire des ch&acirc;ssis et les envoie &agrave; la station B. Ces ch&acirc;ssis s'accumulent, bloquant la station A qui ne peut plus &eacute;vacuer sa production. La station C, en aval, ne re&ccedil;oit plus rien et se retrouve &agrave; l'arr&ecirc;t, incapable de travailler. Une seule panne locale a provoqu&eacute; l'arr&ecirc;t complet de toute la cha&icirc;ne. C'est une <span class="control" id="fi5dut_25">panne en cascade</span>.</p><p id="fi5dut_22">Dans nos microservices, c'est exactement le m&ecirc;me risque. Notre <code class="code" id="fi5dut_26">order-service</code> appelle <code class="code" id="fi5dut_27">product-service</code>. Si <code class="code" id="fi5dut_28">product-service</code> devient tr&egrave;s lent ou tombe en panne, tous les threads de <code class="code" id="fi5dut_29">order-service</code> qui attendent une r&eacute;ponse vont &ecirc;tre bloqu&eacute;s. Bient&ocirc;t, <code class="code" id="fi5dut_30">order-service</code> n'aura plus de threads disponibles pour r&eacute;pondre aux requ&ecirc;tes des utilisateurs. Il deviendra indisponible &agrave; son tour. Si un <code class="code" id="fi5dut_31">api-gateway</code> l'appelle, il sera bloqu&eacute; aussi, et ainsi de suite. L'effet domino peut faire s'effondrer tout le syst&egrave;me.</p><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="552px" preserveAspectRatio="none" style="width:426px;height:552px;background:#FFFFFF;" version="1.1" viewBox="0 0 426 552" width="426px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="227" x="95" y="37.1182">Panne en Cascade</text><!--entity User--><g id="elem_User"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="71" x="51" y="499.9473"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="102" y="504.9473"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="100" y="506.9473"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="100" y="510.9473"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="31" x="66" y="534.0225">User</text></g><!--entity API Gateway--><g id="elem_API Gateway"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="129" x="22" y="370.7373"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="131" y="375.7373"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="129" y="377.7373"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="129" y="381.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="89" x="37" y="404.8125">API Gateway</text></g><!--entity Order Service--><g id="elem_Order Service"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="136" x="18.5" y="212.6373"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="134.5" y="217.6373"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="132.5" y="219.6373"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="132.5" y="223.6373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="96" x="33.5" y="246.7125">Order Service</text></g><!--entity Product Service--><g id="elem_Product Service"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="149" x="12" y="59.7373"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="141" y="64.7373"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="139" y="66.7373"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="139" y="70.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="109" x="27" y="93.8125">Product Service</text></g><g id="elem_GMN12"><path d="M190,183.7473 L190,232.1473 L154.62,236.1473 L190,240.1473 L190,288.5432 A0,0 0 0 0 190,288.5432 L419,288.5432 A0,0 0 0 0 419,288.5432 L419,193.7473 L409,183.7473 L190,183.7473 A0,0 0 0 0 190,183.7473 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M409,183.7473 L409,193.7473 L419,193.7473 L409,183.7473 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="208" x="196" y="201.8171">Tous mes threads sont bloqu&#233;s</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="171" x="196" y="217.6164">en attendant une r&#233;ponse</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="144" x="196" y="233.4158">qui n'arrivera jamais.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="193" x="196" y="249.2151">Je suis maintenant incapable</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="196" x="196" y="265.0144">de r&#233;pondre &#224; l'API Gateway.</text><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="125" x="196" y="280.8137">Je suis en panne.</text></g><g id="elem_GMN15"><path d="M186,365.5473 L186,390.2473 L151.2,394.2473 L186,398.2473 L186,422.9453 A0,0 0 0 0 186,422.9453 L409,422.9453 A0,0 0 0 0 409,422.9453 L409,375.5473 L399,365.5473 L186,365.5473 A0,0 0 0 0 186,365.5473 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M399,365.5473 L399,375.5473 L409,375.5473 L399,365.5473 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="202" x="192" y="383.6171">Order Service ne r&#233;pond plus.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="175" x="192" y="399.4164">Mes threads sont bloqu&#233;s.</text><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="125" x="192" y="415.2158">Je suis en panne.</text></g><g id="elem_GMN18"><path d="M157,510.5473 L157,519.4473 L122.44,523.4473 L157,527.4473 L157,536.3466 A0,0 0 0 0 157,536.3466 L336,536.3466 A0,0 0 0 0 336,536.3466 L336,520.5473 L326,510.5473 L157,510.5473 A0,0 0 0 0 157,510.5473 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M326,510.5473 L326,520.5473 L336,520.5473 L326,510.5473 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="158" x="163" y="528.6171">Le site ne r&#233;pond plus !</text></g><!--reverse link API Gateway to User--><g id="link_API Gateway_User"><path d="M86.5,423.9873 C86.5,446.9973 86.5,476.3773 86.5,499.4773 " fill="none" id="API Gateway-backto-User" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="86.5,417.9873,82.5,426.9873,86.5,422.9873,90.5,426.9873,86.5,417.9873" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="54" x="87.5" y="467.0171">Requ&#234;te</text></g><!--reverse link Order Service to API Gateway--><g id="link_Order Service_API Gateway"><path d="M86.5,265.8473 C86.5,295.3573 86.5,340.6173 86.5,370.2673 " fill="none" id="Order Service-backto-API Gateway" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="86.5,259.8473,82.5,268.8473,86.5,264.8473,90.5,268.8473,86.5,259.8473" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="54" x="87.5" y="332.6171">Requ&#234;te</text></g><!--reverse link Product Service to Order Service--><g id="link_Product Service_Order Service"><path d="M86.5,113.1573 C86.5,141.6873 86.5,184.1073 86.5,212.5073 " fill="none" id="Product Service-backto-Order Service" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="86.5,107.1573,82.5,116.1573,86.5,112.1573,90.5,116.1573,86.5,107.1573" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="54" x="87.5" y="150.8171">Requ&#234;te</text></g><!--SRC=[dP5DJiD038NtESLhDvKYjGTWWOHO8128Y9zLrOMRCSsWP2QTyHHn6xRb6haOJgj2Vs33BCVlU_Qp1r9nmsXhiYuJApLZM91p37Quf5YIuM6MJPyZXnd6QNoEwKLnZIiIVgFt6SxmmClKVGfdXuMjzZuO3dZaiB8b7wgFIbjz4Rn9fVnAw7DU6C4kAe5_ENRFW2UV8XgEa2emcOZedM1UUxLOHnLeAX9XPqZ_ayOCtRhrBhBMbid2ZIW4k-90UAM6R9neuOOHarLZNPAoFMfTIItDwvupEnSJ6Dq7wj7U8de-ptSEshxjjpl9yqo7G9_d9DN-6fK-28dlaOqUBMt6k_ihxpzwR-wisAr2LaxQOV23VW40]--></g></svg></div><p id="fi5dut_24">Pour &eacute;viter cela, nous devons apprendre &agrave; nos services &agrave; &ecirc;tre plus intelligents et &agrave; ne pas insister b&ecirc;tement quand un de leurs partenaires est en difficult&eacute;.</p></section><section class="chapter"><h2 id="le-pattern-circuit-breaker-disjoncteur" data-toc="le-pattern-circuit-breaker-disjoncteur">Le Pattern Circuit Breaker (Disjoncteur)</h2><p id="fi5dut_32">Ce pattern tire son nom des disjoncteurs &eacute;lectriques de votre maison. Si un appareil est d&eacute;fectueux et provoque un court-circuit, le disjoncteur &quot;saute&quot; (s'ouvre) pour couper le courant et prot&eacute;ger le reste de votre installation &eacute;lectrique (et &eacute;viter un incendie).</p><p id="fi5dut_33">Le Circuit Breaker logiciel fait la m&ecirc;me chose : il surveille les appels vers un service distant. S'il d&eacute;tecte trop d' &eacute;checs, il &quot;saute&quot; et arr&ecirc;te d'envoyer des appels vers ce service pendant un certain temps. Il prot&egrave;ge ainsi le service appelant (le &quot;consumer&quot;) d'une attente inutile et le service distant (le &quot;provider&quot;) d'une surcharge de requ&ecirc;tes alors qu'il est d&eacute;j&agrave; en difficult&eacute;.</p><p id="fi5dut_34">Le Circuit Breaker a trois &eacute;tats :</p><ol class="list _decimal" id="fi5dut_35" type="1"><li class="list__item" id="fi5dut_37"><p id="fi5dut_40"><span class="control" id="fi5dut_41"><code class="code" id="fi5dut_43">CLOSED</code> (Ferm&eacute;) :</span> C'est l'&eacute;tat normal. Les appels passent &agrave; travers le disjoncteur vers le service distant. Le disjoncteur compte les succ&egrave;s et les &eacute;checs. Si le nombre d'&eacute;checs d&eacute;passe un certain seuil (ex: 50% d'&eacute;checs sur les 10 derni&egrave;res requ&ecirc;tes), il passe &agrave; l'&eacute;tat <code class="code" id="fi5dut_42">OPEN</code>.</p></li><li class="list__item" id="fi5dut_38"><p id="fi5dut_44"><span class="control" id="fi5dut_45"><code class="code" id="fi5dut_47">OPEN</code> (Ouvert) :</span> Le disjoncteur a &quot;saut&eacute;&quot;. Pendant une dur&eacute;e configur&eacute;e (ex: 30 secondes), <span class="control" id="fi5dut_46">tous les appels sont imm&eacute;diatement rejet&eacute;s</span> sans m&ecirc;me essayer de contacter le service distant. Cela donne au service en panne le temps de r&eacute;cup&eacute;rer et prot&egrave;ge le service appelant.</p></li><li class="list__item" id="fi5dut_39"><p id="fi5dut_48"><span class="control" id="fi5dut_50"><code class="code" id="fi5dut_52">HALF-OPEN</code> (Semi-ouvert) :</span> Une fois le temps d'attente &eacute;coul&eacute;, le disjoncteur entre dans cet &eacute;tat de test. Il autorise un <span class="control" id="fi5dut_51">nombre limit&eacute; de requ&ecirc;tes de test</span> &agrave; passer.</p><ul class="list _bullet" id="fi5dut_49"><li class="list__item" id="fi5dut_53"><p id="fi5dut_55">Si ces requ&ecirc;tes r&eacute;ussissent, le disjoncteur consid&egrave;re que le service est de nouveau op&eacute;rationnel et repasse &agrave; l'&eacute;tat <code class="code" id="fi5dut_56">CLOSED</code>. Le trafic normal reprend.</p></li><li class="list__item" id="fi5dut_54"><p id="fi5dut_57">Si ces requ&ecirc;tes &eacute;chouent, il conclut que le service est toujours en panne et retourne &agrave; l'&eacute;tat <code class="code" id="fi5dut_58">OPEN</code> pour une nouvelle p&eacute;riode d'attente.</p></li></ul></li></ol><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="410px" preserveAspectRatio="none" style="width:605px;height:410px;background:#FFFFFF;" version="1.1" viewBox="0 0 605 410" width="605px" zoomAndPan="magnify"><defs/><g><path d="M227,208.05 L375,208.05 A12.5,12.5 0 0 1 387.5,220.55 L387.5,235.0646 L214.5,235.0646 L214.5,220.55 A12.5,12.5 0 0 1 227,208.05 " fill="#FFFFFF" style="stroke:#FFFFFF;stroke-width:1.0;"/><path d="M214.5,235.0646 L387.5,235.0646 L387.5,294.5646 A12.5,12.5 0 0 1 375,307.0646 L227,307.0646 A12.5,12.5 0 0 1 214.5,294.5646 L214.5,235.0646 " fill="#FFFFFF" style="stroke:#FFFFFF;stroke-width:1.0;"/><rect fill="none" height="99.0146" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="173" x="214.5" y="208.05"/><line style="stroke:#000000;stroke-width:1.0;" x1="214.5" x2="387.5" y1="235.0646" y2="235.0646"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="59" x="271.5" y="227.1252">CLOSED</text><g id="Closed.Les appels passent"><rect fill="#FFFFFF" height="50" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="152" x="226.5" y="247.0646"/><line style="stroke:#000000;stroke-width:1.0;" x1="226.5" x2="378.5" y1="274.0793" y2="274.0793"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="132" x="236.5" y="266.1398">Les appels passent</text></g><path d="M24.5,12 L207.5,12 A12.5,12.5 0 0 1 220,24.5 L220,39.0146 L12,39.0146 L12,24.5 A12.5,12.5 0 0 1 24.5,12 " fill="#FFFFFF" style="stroke:#FFFFFF;stroke-width:1.0;"/><path d="M12,39.0146 L220,39.0146 L220,102.5439 A12.5,12.5 0 0 1 207.5,115.0439 L24.5,115.0439 A12.5,12.5 0 0 1 12,102.5439 L12,39.0146 " fill="#FFFFFF" style="stroke:#FFFFFF;stroke-width:1.0;"/><rect fill="none" height="103.0439" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="208" x="12" y="12"/><line style="stroke:#000000;stroke-width:1.0;" x1="12" x2="220" y1="39.0146" y2="39.0146"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="38" x="97" y="31.0752">OPEN</text><g id="Open.Les appels sont bloqu&#233;s\nimm&#233;diatement"><rect fill="#FFFFFF" height="54.0293" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="187" x="24" y="51.0146"/><line style="stroke:#000000;stroke-width:1.0;" x1="24" x2="211" y1="95.0439" y2="95.0439"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="167" x="34" y="70.0898">Les appels sont bloqu&#233;s</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="112" x="61.5" y="87.1045">imm&#233;diatement</text></g><path d="M394.5,12 L579.5,12 A12.5,12.5 0 0 1 592,24.5 L592,39.0146 L382,39.0146 L382,24.5 A12.5,12.5 0 0 1 394.5,12 " fill="#FFFFFF" style="stroke:#FFFFFF;stroke-width:1.0;"/><path d="M382,39.0146 L592,39.0146 L592,102.5439 A12.5,12.5 0 0 1 579.5,115.0439 L394.5,115.0439 A12.5,12.5 0 0 1 382,102.5439 L382,39.0146 " fill="#FFFFFF" style="stroke:#FFFFFF;stroke-width:1.0;"/><rect fill="none" height="103.0439" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="210" x="382" y="12"/><line style="stroke:#000000;stroke-width:1.0;" x1="382" x2="592" y1="39.0146" y2="39.0146"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="84" x="445" y="31.0752">HALF_OPEN</text><g id="HalfOpen.Quelques appels de test\nsont autoris&#233;s"><rect fill="#FFFFFF" height="54.0293" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="189" x="394" y="51.0146"/><line style="stroke:#000000;stroke-width:1.0;" x1="394" x2="583" y1="95.0439" y2="95.0439"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="169" x="404" y="70.0898">Quelques appels de test</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="98" x="439.5" y="87.1045">sont autoris&#233;s</text></g><ellipse cx="301" cy="394.06" fill="#FFFFFF" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;"/><!--reverse link Closed to *start*--><g id="link_Closed_*start*"><path d="M301,313.49 C301,341.44 301,367.94 301,383.63 " fill="none" id="Closed-backto-*start*" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="301,307.49,297,316.49,301,312.49,305,316.49,301,307.49" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="75" x="302" y="351.1298">D&#233;marrage</text></g><!--reverse link Open to Closed--><g id="link_Open_Closed"><path d="M169.2525,119.8013 C196.7625,148.3613 226.74,179.47 253.92,207.68 " fill="none" id="Open-backto-Closed" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="165.09,115.48,168.4528,124.737,168.5587,119.0811,174.2146,119.187,165.09,115.48" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="87" x="226.07" y="159.1198">Seuil d'&#233;chec</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="43" x="248.07" y="174.9191">atteint</text></g><!--link Open to HalfOpen--><g id="link_Open_HalfOpen"><path d="M220.33,63.52 C270.7,63.52 325.01,63.52 375.52,63.52 " fill="none" id="Open-to-HalfOpen" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="381.52,63.52,372.52,59.52,376.52,63.52,372.52,67.52,381.52,63.52" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="105" x="248.5" y="41.5898">Apr&#232;s un temps</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="125" x="238.5" y="57.3891">d'attente (ex: 30s)</text></g><!--link HalfOpen to Open--><g id="link_HalfOpen_Open"><path d="M381.83,96.15 C375.33,97.48 368.85,98.62 362.5,99.52 C308.37,107.19 293.62,107.25 239.5,99.52 C233.2,98.62 232.6464,98.6917 226.1964,97.3617 " fill="none" id="HalfOpen-to-Open" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="220.32,96.15,228.3267,101.8852,225.217,97.1598,229.9424,94.05,220.32,96.15" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="121" x="240.5" y="80.5898">Les appels de test</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="60" x="271" y="96.3891">&#233;chouent</text></g><!--link HalfOpen to Closed--><g id="link_HalfOpen_Closed"><path d="M437.64,115.48 C409.98,144.04 379.8341,175.1599 352.5141,203.3699 " fill="none" id="HalfOpen-to-Closed" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="348.34,207.68,357.4745,203.9976,351.8184,204.0883,351.7278,198.4321,348.34,207.68" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="121" x="406.14" y="159.1198">Les appels de test</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="75" x="429.14" y="174.9191">r&#233;ussissent</text></g><!--SRC=[TP3FIWCn4CRlUOfnBrMX87ZRWr3wXnuML-dH5OdTiGqasNHd0eBuFkvpvCNCXkrgiUQO-NxVzyrSy1uDWjDIMK4i6I6R5-LckSX04inrGrZ3Xu3uXd611D8vr0HE4g7bJ7mUsV9XUP_8qg7zbwF6Chpgvk13HvLLneIkLb5bJjtMisBrCbgkfNxxQ_leKH_yZtUDm4XSsHGYFJUjeXZJsugdwsUO-kdTSR4S5g4pictb3eKOFfCW1UMmGQyqr9FGRVUuhQnaHcLPY3IFkh5K3ZFNXYy2RsC1u-9UzQINszZo4jzpkBsXAo56u7UBuap_DdIUIAKBdr13t3cchzdu27m3]--></g></svg></div></section><section class="chapter"><h2 id="le-concept-de-fallback-m-thode-de-repli" data-toc="le-concept-de-fallback-m-thode-de-repli">Le Concept de &quot;Fallback&quot; (M&eacute;thode de Repli)</h2><p id="fi5dut_59">Ok, le disjoncteur est ouvert, l'appel est bloqu&eacute;. Mais que fait-on &agrave; la place ? On ne va pas juste renvoyer une erreur brute &agrave; l'utilisateur. C'est l&agrave; qu'intervient le <span class="control" id="fi5dut_65">Fallback</span>.</p><aside class="prompt" data-type="tip" data-title="" id="fi5dut_60"><p id="fi5dut_66"><span class="control" id="fi5dut_67">D&eacute;finition :</span> Un <span class="control" id="fi5dut_68">Fallback</span> est une m&eacute;thode de repli qui est ex&eacute;cut&eacute;e lorsque l'appel principal &eacute;choue (soit &agrave; cause d'une erreur, soit parce que le Circuit Breaker est ouvert).</p></aside><p id="fi5dut_61">C'est une logique alternative qui permet de fournir une r&eacute;ponse d&eacute;grad&eacute;e mais acceptable, plut&ocirc;t que pas de r&eacute;ponse du tout.</p><p id="fi5dut_62"><span class="control" id="fi5dut_69">Exemples de fallbacks pour notre <code class="code" id="fi5dut_70">order-service</code> qui appelle <code class="code" id="fi5dut_71">product-service</code>:</span></p><ul class="list _bullet" id="fi5dut_63"><li class="list__item" id="fi5dut_72"><p id="fi5dut_76"><span class="control" id="fi5dut_77">R&eacute;cup&eacute;rer des donn&eacute;es d'un cache :</span> Si nous avions une copie en cache des informations du produit, le fallback pourrait renvoyer ces donn&eacute;es, m&ecirc;me si elles ne sont pas 100% &agrave; jour.</p></li><li class="list__item" id="fi5dut_73"><p id="fi5dut_78"><span class="control" id="fi5dut_79">Retourner une valeur par d&eacute;faut :</span> Le fallback pourrait renvoyer un objet <code class="code" id="fi5dut_80">ProductDTO</code> avec des informations g&eacute;n&eacute;riques (&quot;Information produit indisponible&quot;) ou un prix moyen.</p></li><li class="list__item" id="fi5dut_74"><p id="fi5dut_81"><span class="control" id="fi5dut_82">Enclencher une logique m&eacute;tier alternative :</span> Mettre la demande de commande dans une file d'attente pour un traitement ult&eacute;rieur.</p></li><li class="list__item" id="fi5dut_75"><p id="fi5dut_83"><span class="control" id="fi5dut_84">Retourner une r&eacute;ponse d'erreur contr&ocirc;l&eacute;e :</span> C'est le fallback le plus simple, mais d&eacute;j&agrave; mieux qu'une exception non g&eacute;r&eacute;e.</p></li></ul><p id="fi5dut_64">Le fallback est essentiel pour maintenir une bonne exp&eacute;rience utilisateur m&ecirc;me en cas de panne partielle du syst&egrave;me.</p></section><section class="chapter"><h2 id="notre-outil-resilience4j" data-toc="notre-outil-resilience4j">Notre Outil : Resilience4j</h2><p id="fi5dut_85">Pendant des ann&eacute;es, la solution de Netflix, <span class="control" id="fi5dut_92">Hystrix</span>, a &eacute;t&eacute; le standard pour les Circuit Breakers dans l'&eacute;cosyst&egrave;me Spring Cloud. Cependant, Hystrix est maintenant en mode maintenance et n'est plus d&eacute;velopp&eacute; activement.</p><p id="fi5dut_86">Son successeur officiel, recommand&eacute; par l'&eacute;quipe Spring, est <span class="control" id="fi5dut_93">Resilience4j</span>. C'est une biblioth&egrave;que de tol&eacute;rance aux pannes l&eacute;g&egrave;re, modulaire et con&ccedil;ue pour Java 8 et la programmation fonctionnelle. Elle ne fournit pas seulement des Circuit Breakers, mais aussi d'autres patterns de r&eacute;silience comme les Rate Limiters, Retries, etc.</p><p id="fi5dut_87">L'int&eacute;gration avec Spring Boot est tr&egrave;s simple gr&acirc;ce &agrave; des annotations. Pour prot&eacute;ger une m&eacute;thode avec un Circuit Breaker, on utilisera principalement l'annotation <code class="code" id="fi5dut_94">@CircuitBreaker</code>.</p><p id="fi5dut_88"><span class="control" id="fi5dut_95">Exemple conceptuel :</span></p><div class="code-block" data-lang="java">
// Dans notre ProductServiceClient de 'order-service'

@FeignClient(name = &quot;product-service&quot;)
public interface ProductServiceClient {

    @GetMapping(&quot;/api/products/{id}&quot;)
    @CircuitBreaker(name = &quot;productServiceBreaker&quot;, fallbackMethod = &quot;getProductFallback&quot;)
    ProductDTO findProductById(@PathVariable(&quot;id&quot;) Long id);

    // La méthode de fallback DOIT avoir la même signature que la méthode protégée,
    // plus un paramètre pour l'exception si on veut la traiter.
    default ProductDTO getProductFallback(Long id, Throwable throwable) {
        // Logique de repli ici
        System.out.println(&quot;Circuit Breaker activé ! Fallback pour produit ID: &quot; + id);
        // On retourne un DTO par défaut
        ProductDTO defaultProduct = new ProductDTO();
        defaultProduct.setId(id);
        defaultProduct.setName(&quot;Produit indisponible pour le moment&quot;);
        defaultProduct.setPrice(0.0);
        defaultProduct.setStock(0);
        return defaultProduct;
    }
}
</div><aside class="prompt" data-type="warning" data-title="" id="fi5dut_90"><p><b id="fi5dut_96">D&eacute;finition du Fallback</b> Dans les versions modernes de Spring, la m&eacute;thode de fallback ne peut plus se trouver directement dans l'interface Feign. Elle doit &ecirc;tre dans une classe s&eacute;par&eacute;e, sp&eacute;cifi&eacute;e dans l'annotation <code class="code" id="fi5dut_97">@FeignClient</code>. Nous verrons cette impl&eacute;mentation correcte dans le TP. L'exemple ci-dessus est simplifi&eacute; pour l'explication du concept.</p></aside></section><section class="chapter"><h2 id="conclusion-de-la-partie" data-toc="conclusion-de-la-partie">Conclusion de la partie</h2><p id="fi5dut_98">Vous avez maintenant ajout&eacute; une comp&eacute;tence fondamentale &agrave; votre arsenal d'architecte logiciel : la <span class="control" id="fi5dut_103">r&eacute;silience</span>. Vous comprenez le danger des <span class="control" id="fi5dut_104">pannes en cascade</span> et vous savez comment les pr&eacute;venir gr&acirc;ce au pattern <span class="control" id="fi5dut_105">Circuit Breaker</span>.</p><p id="fi5dut_99">Vous avez diss&eacute;qu&eacute; les trois &eacute;tats du disjoncteur (<code class="code" id="fi5dut_106">CLOSED</code>, <code class="code" id="fi5dut_107">OPEN</code>, <code class="code" id="fi5dut_108">HALF-OPEN</code>) et compris comment il prot&egrave;ge &agrave; la fois le consommateur et le fournisseur de services. Vous avez aussi vu l'importance d'un <span class="control" id="fi5dut_109">Fallback</span> pour fournir une exp&eacute;rience utilisateur d&eacute;grad&eacute;e mais fonctionnelle plut&ocirc;t qu'une erreur brute.</p><p id="fi5dut_100">Enfin, vous avez identifi&eacute; <span class="control" id="fi5dut_110">Resilience4j</span> comme l'outil moderne et puissant que nous utiliserons pour impl&eacute;menter ce pattern de mani&egrave;re &eacute;l&eacute;gante avec Spring Boot.</p><p id="fi5dut_101">Dans le TP suivant, nous allons mettre en pratique cette th&eacute;orie. Nous allons ajouter Resilience4j &agrave; notre <code class="code" id="fi5dut_111">order-service</code>, prot&eacute;ger l'appel OpenFeign vers <code class="code" id="fi5dut_112">product-service</code>, et simuler une panne pour voir notre Circuit Breaker s'ouvrir et notre m&eacute;thode de fallback se d&eacute;clencher sous nos yeux.</p></section><section class="chapter"><h2 id="auto-valuation" data-toc="auto-valuation">Auto-&eacute;valuation</h2><p id="fi5dut_113">Prenez un moment pour r&eacute;pondre &agrave; ces questions. Les corrections se trouvent &agrave; la toute fin du support de cours.</p><ol class="list _decimal" id="fi5dut_114" type="1"><li class="list__item" id="fi5dut_115"><p id="fi5dut_120"><span class="control" id="fi5dut_121">(Question ouverte)</span> Expliquez pourquoi un Circuit Breaker prot&egrave;ge non seulement le service &quot;appelant&quot; (consumer) mais aussi le service &quot;appel&eacute;&quot; (provider) qui est en difficult&eacute;.</p></li><li class="list__item" id="fi5dut_116"><p id="fi5dut_122"><span class="control" id="fi5dut_124">(QCM)</span> Dans quel &eacute;tat un Circuit Breaker bloque-t-il imm&eacute;diatement les appels sans essayer de contacter le service distant ?</p><ul class="list _bullet" id="fi5dut_123"><li class="list__item" id="fi5dut_125"><p id="fi5dut_129">A) <code class="code" id="fi5dut_130">CLOSED</code></p></li><li class="list__item" id="fi5dut_126"><p id="fi5dut_131">B) <code class="code" id="fi5dut_132">HALF-OPEN</code></p></li><li class="list__item" id="fi5dut_127"><p id="fi5dut_133">C) <code class="code" id="fi5dut_134">OPEN</code></p></li><li class="list__item" id="fi5dut_128"><p id="fi5dut_135">D) <code class="code" id="fi5dut_136">DISABLED</code></p></li></ul></li><li class="list__item" id="fi5dut_117"><p id="fi5dut_137"><span class="control" id="fi5dut_139">(QCM)</span> Quel est le but principal d'une m&eacute;thode de &quot;Fallback&quot; ?</p><ul class="list _bullet" id="fi5dut_138"><li class="list__item" id="fi5dut_140"><p id="fi5dut_144">A) Relancer l'appel automatiquement.</p></li><li class="list__item" id="fi5dut_141"><p id="fi5dut_145">B) Arr&ecirc;ter le service appelant pour &eacute;viter les erreurs.</p></li><li class="list__item" id="fi5dut_142"><p id="fi5dut_146">C) Fournir une r&eacute;ponse alternative ou d&eacute;grad&eacute;e quand l'appel principal &eacute;choue.</p></li><li class="list__item" id="fi5dut_143"><p id="fi5dut_147">D) Envoyer une alerte &agrave; l'administrateur syst&egrave;me.</p></li></ul></li><li class="list__item" id="fi5dut_118"><p id="fi5dut_148"><span class="control" id="fi5dut_149">(Question ouverte)</span> D&eacute;crivez le comportement du Circuit Breaker dans l'&eacute;tat <code class="code" id="fi5dut_150">HALF-OPEN</code>. Quel est son objectif ?</p></li><li class="list__item" id="fi5dut_119"><p id="fi5dut_151"><span class="control" id="fi5dut_153">(QCM)</span> Quel outil a largement remplac&eacute; Hystrix et est aujourd'hui la solution de r&eacute;silience recommand&eacute;e pour les applications Spring Cloud ?</p><ul class="list _bullet" id="fi5dut_152"><li class="list__item" id="fi5dut_154"><p id="fi5dut_158">A) Eureka</p></li><li class="list__item" id="fi5dut_155"><p id="fi5dut_159">B) Feign</p></li><li class="list__item" id="fi5dut_156"><p id="fi5dut_160">C) Resilience4j</p></li><li class="list__item" id="fi5dut_157"><p id="fi5dut_161">D) Zuul</p></li></ul></li></ol></section><div class="last-modified">16 juillet 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="005-01-tp-5.html" class="navigation-links__prev">TP 5 : Un seul pour les gouverner tous - Mise en place de la Configuration Centralis&eacute;e</a><a href="006-01-tp-6.html" class="navigation-links__next">TP 6 : &quot;Houston, nous avons un probl&egrave;me&quot; - Impl&eacute;mentation d'un Circuit Breaker</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>