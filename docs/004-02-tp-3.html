<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-31T08:30:08.627682"><title>TP 3 : &quot;Je suis l&agrave; !&quot; - Enregistrement des services aupr&egrave;s d'Eureka | Spring Micro Services</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs Pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction-connecter-le-navire-au-phare","level":0,"title":"Introduction : Connecter le navire au phare","anchor":"#introduction-connecter-le-navire-au-phare"},{"id":"tp-enregistrement-de-product-service","level":0,"title":"TP : Enregistrement de product-service","anchor":"#tp-enregistrement-de-product-service"},{"id":"exercice-6-comprendre-l-impact-d-un-arr-t","level":0,"title":"Exercice 6 : Comprendre l\u0027impact d\u0027un arrêt","anchor":"#exercice-6-comprendre-l-impact-d-un-arr-t"},{"id":"auto-valuation","level":0,"title":"Auto-évaluation","anchor":"#auto-valuation"},{"id":"conclusion","level":0,"title":"Conclusion","anchor":"#conclusion"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="TP 3 : &quot;Je suis l&agrave; !&quot; - Enregistrement des services aupr&egrave;s d'Eureka | Spring Micro Services"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Spring Micro Services Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/004-02-tp-3.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="TP 3 : &quot;Je suis l&agrave; !&quot; - Enregistrement des services aupr&egrave;s d'Eureka | Spring Micro Services"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/004-02-tp-3.html#webpage",
    "url": "writerside-documentation/004-02-tp-3.html",
    "name": "TP 3 : &quot;Je suis l&agrave; !&quot; - Enregistrement des services aupr&egrave;s d'Eureka | Spring Micro Services",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Spring Micro Services Help"
}</script><!-- End Schema.org --></head><body data-id="004-02-TP-3" data-main-title="TP 3 : &quot;Je suis là !&quot; - Enregistrement des services auprès d'Eureka" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="004-00-service-discovery.md|Module 4 : La Découverte de Services - Qui est où ? (L'essentiel)"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Spring Micro Services  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="004-02-TP-3" id="004-02-TP-3.md">TP 3 : &quot;Je suis là !&quot; - Enregistrement des services auprès d'Eureka</h1><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs P&eacute;dagogiques</h2><p id="z4hagzo_9">&Agrave; la fin de ce TP, vous serez capable de :</p><ul class="list _bullet" id="z4hagzo_10"><li class="list__item" id="z4hagzo_11"><p id="z4hagzo_15">Transformer un microservice Spring Boot standard en client Eureka.</p></li><li class="list__item" id="z4hagzo_12"><p id="z4hagzo_16">Ajouter et configurer la d&eacute;pendance <code class="code" id="z4hagzo_17">eureka-client</code>.</p></li><li class="list__item" id="z4hagzo_13"><p id="z4hagzo_18">Configurer un microservice pour qu'il s'enregistre aupr&egrave;s d'un serveur Eureka.</p></li><li class="list__item" id="z4hagzo_14"><p id="z4hagzo_19">Valider l'enregistrement en consultant le tableau de bord d'Eureka.</p></li></ul></section><section class="chapter"><h2 id="introduction-connecter-le-navire-au-phare" data-toc="introduction-connecter-le-navire-au-phare">Introduction : Connecter le navire au phare</h2><p id="z4hagzo_20">Notre serveur Eureka est comme un port flambant neuf : les quais sont pr&ecirc;ts, la capitainerie (le dashboard) est ouverte, mais il n'y a aucun bateau. Notre <code class="code" id="z4hagzo_23">product-service</code>, lui, est comme un navire en mer, pr&ecirc;t &agrave; commercer, mais il navigue &agrave; l'aveugle.</p><p id="z4hagzo_21">Le but de ce TP est de donner &agrave; notre <code class="code" id="z4hagzo_24">product-service</code> une radio et la bonne fr&eacute;quence pour contacter la tour de contr&ocirc;le du port. Nous allons l'&eacute;quiper pour qu'il devienne un <span class="control" id="z4hagzo_25">client Eureka</span>.</p><p id="z4hagzo_22">Concr&egrave;tement, nous allons modifier le <code class="code" id="z4hagzo_26">product-service</code> pour qu'&agrave; son d&eacute;marrage, il contacte le serveur Eureka que nous avons lanc&eacute; dans le TP pr&eacute;c&eacute;dent et qu'il s'y enregistre. Nous pourrons alors visualiser sa pr&eacute;sence directement dans l'interface web d'Eureka, ce qui sera la preuve que notre &eacute;cosyst&egrave;me commence &agrave; prendre vie. C'est une &eacute;tape tr&egrave;s gratifiante, car c'est la premi&egrave;re fois que nos composants vont activement interagir.</p></section><section class="chapter"><h2 id="tp-enregistrement-de-product-service" data-toc="tp-enregistrement-de-product-service">TP : Enregistrement de <code class="code" id="z4hagzo_32">product-service</code></h2><section class="procedure-steps" id="z4hagzo_28"><p id="z4hagzo_33"><b id="z4hagzo_63">Pr&eacute;-requis :</b> Le conteneur Docker de votre serveur Eureka (`my-eureka-server`) doit &ecirc;tre en cours d'ex&eacute;cution. V&eacute;rifiez avec <code class="code" id="z4hagzo_64">docker ps</code> et que vous pouvez acc&eacute;der &agrave; <a href="http://localhost:8761/" id="z4hagzo_65" data-external="true" rel="noopener noreferrer" target="_blank">http://localhost:8761/</a>.</p><p id="z4hagzo_34"><b id="z4hagzo_66">&Eacute;tape 1 : Ajout de la d&eacute;pendance Eureka Client</b></p><p id="z4hagzo_35">Ouvrez le projet <code class="code" id="z4hagzo_67">product-service</code> dans votre IDE.</p><p id="z4hagzo_36">Nous devons ajouter la d&eacute;pendance qui contient toute la logique du client Eureka. Ouvrez le fichier <code class="code" id="z4hagzo_68">pom.xml</code>.</p><p id="z4hagzo_37">Spring Cloud utilise un &quot;Bill of Materials&quot; (BOM) pour g&eacute;rer les versions de ses diff&eacute;rentes biblioth&egrave;ques de mani&egrave;re coh&eacute;rente. Nous devons d'abord ajouter ce BOM dans la section <code class="code" id="z4hagzo_69">&lt;dependencyManagement&gt;</code>.</p><div class="code-block" data-lang="markup">
&lt;!-- Dans product-service/pom.xml --&gt;
&lt;dependencyManagement&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;
            &lt;!-- Remplacez par la version compatible avec votre Spring Boot --&gt;
            &lt;!-- Par exemple, 2023.0.0 pour Spring Boot 3.2.x --&gt;
            &lt;version&gt;2023.0.0&lt;/version&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;scope&gt;import&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;
</div><aside class="prompt" data-type="tip" data-title="" id="z4hagzo_39"><p id="z4hagzo_70"><span class="control" id="z4hagzo_71">Conseil :</span> Pour trouver la bonne version de <code class="code" id="z4hagzo_72">spring-cloud-dependencies</code>, vous pouvez consulter la documentation officielle de Spring Cloud ou la page du projet sur Spring Initializr. La compatibilit&eacute; entre les versions de Spring Boot et Spring Cloud est tr&egrave;s importante.</p></aside><p id="z4hagzo_40">Maintenant, ajoutez la d&eacute;pendance du client Eureka dans la section <code class="code" id="z4hagzo_73">&lt;dependencies&gt;</code>:</p><div class="code-block" data-lang="markup">
&lt;!-- Dans product-service/pom.xml, à l'intérieur de &lt;dependencies&gt; --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
&lt;/dependency&gt;
</div><p id="z4hagzo_42">Apr&egrave;s avoir modifi&eacute; le `pom.xml`, n'oubliez pas de demander &agrave; Maven de recharger les d&eacute;pendances (votre IDE le propose g&eacute;n&eacute;ralement automatiquement).</p><p id="z4hagzo_43"><b id="z4hagzo_74">&Eacute;tape 2 : Configuration de l'application</b></p><p id="z4hagzo_44">Maintenant que notre service a la capacit&eacute; technique d'&ecirc;tre un client Eureka, nous devons lui dire o&ugrave; se trouve le serveur.</p><p id="z4hagzo_45">Ouvrez le fichier <code class="code" id="z4hagzo_75">src/main/resources/application.properties</code> du <code class="code" id="z4hagzo_76">product-service</code> et ajoutez la ligne suivante :</p><div class="code-block" data-lang="properties">
# ... (configurations existantes : server.port, spring.application.name, etc.)
# URL du serveur Eureka où ce service doit s'enregistrer.
# C'est l'adresse de notre serveur Eureka, suivie de /eureka.
eureka.client.serviceUrl.defaultZone=http://localhost:8761/eureka
</div><p id="z4hagzo_47">C'est tout ! Le nom de l'application, que nous avions d&eacute;j&agrave; d&eacute;fini avec <code class="code" id="z4hagzo_77">spring.application.name=product-service</code>, sera utilis&eacute; comme identifiant unique du service dans l'annuaire Eureka.</p><p id="z4hagzo_48"><b id="z4hagzo_78">&Eacute;tape 3 : Lancement et v&eacute;rification</b></p><p id="z4hagzo_49">Arr&ecirc;tez le conteneur du <code class="code" id="z4hagzo_79">product-service</code> s'il est encore en cours d'ex&eacute;cution (<code class="code" id="z4hagzo_80">docker stop my-product-service</code>).</p><p id="z4hagzo_50">Pour ce test, il est plus simple de lancer le <code class="code" id="z4hagzo_81">product-service</code> directement depuis votre IDE (en ex&eacute;cutant la m&eacute;thode <code class="code" id="z4hagzo_82">main</code> de <code class="code" id="z4hagzo_83">ProductServiceApplication</code>). Cela vous permettra de voir les logs plus facilement.</p><p id="z4hagzo_51">Pendant le d&eacute;marrage, surveillez la console. Vous devriez voir des logs indiquant que le client Eureka contacte le serveur :</p><p>... DiscoveryClient_PRODUCT-SERVICE/DESKTOP-XXXXX... - registration status: 204 ... </p><p id="z4hagzo_52">Maintenant, l'&eacute;tape de v&eacute;rit&eacute; : rafra&icirc;chissez la page du tableau de bord Eureka dans votre navigateur (<a href="http://localhost:8761/" id="z4hagzo_84" data-external="true" rel="noopener noreferrer" target="_blank">http://localhost:8761/</a>).</p><p id="z4hagzo_53">Victoire ! Vous devriez voir votre service appara&icirc;tre dans la liste des instances enregistr&eacute;es.</p><figure id="z4hagzo_54"><img alt="Product Service registered in Eureka" src="${primarySource}" title="Product Service registered in Eureka"></figure><p id="z4hagzo_55">Le tableau de bord vous donne des informations pr&eacute;cieuses :</p><ul class="list _bullet" id="z4hagzo_56"><li class="list__item" id="z4hagzo_85"><p><b id="z4hagzo_89">Application :</b> Le nom que nous avons donn&eacute;, `PRODUCT-SERVICE`. C'est sous ce nom que les autres services le chercheront.</p></li><li class="list__item" id="z4hagzo_86"><p><b id="z4hagzo_90">AMIs :</b> Non pertinent pour nous (concerne AWS).</p></li><li class="list__item" id="z4hagzo_87"><p><b id="z4hagzo_91">Availability Zones :</b> Le nombre d'instances (1).</p></li><li class="list__item" id="z4hagzo_88"><p><b id="z4hagzo_92">Status :</b> L'instance est `UP` (disponible) et indique son adresse IP et son port.</p></li></ul><p id="z4hagzo_57"><b id="z4hagzo_93">&Eacute;tape 4 : Mettre &agrave; jour l'image Docker</b></p><p id="z4hagzo_58">Maintenant que &ccedil;a fonctionne depuis l'IDE, mettons &agrave; jour notre image Docker pour inclure ces changements.</p><p id="z4hagzo_59">Ouvrez un terminal &agrave; la racine du projet <code class="code" id="z4hagzo_94">product-service</code>.</p><div class="code-block" data-lang="bash">
# Re-construire le .jar avec les nouvelles dépendances
mvn clean package


# Re-construire l'image Docker avec la nouvelle version du code

docker build -t product-service:1.1 .
</div><p id="z4hagzo_61">Notez que nous avons chang&eacute; le tag de la version en `1.1` pour refl&eacute;ter les modifications.</p><aside class="prompt" data-type="warning" data-title="" id="z4hagzo_62"><p><b id="z4hagzo_95">Probl&egrave;me de r&eacute;seau Docker !</b></p><p id="z4hagzo_96">Si vous lancez maintenant le conteneur <code class="code" id="z4hagzo_98">product-service</code> avec <code class="code" id="z4hagzo_99">docker run</code>, il ne pourra pas trouver le conteneur Eureka. Pourquoi ? Parce que <code class="code" id="z4hagzo_100">localhost</code> &agrave; l'int&eacute;rieur d'un conteneur Docker d&eacute;signe... le conteneur lui-m&ecirc;me, et non la machine h&ocirc;te !</p><p id="z4hagzo_97">Nous r&eacute;soudrons ce probl&egrave;me de communication entre conteneurs de mani&egrave;re propre et d&eacute;finitive avec <b id="z4hagzo_101">Docker Compose</b> dans un module ult&eacute;rieur. Pour l'instant, le fait que cela fonctionne depuis l'IDE suffit &agrave; valider notre configuration.</p></aside><ol class="list _decimal"></ol></section><p id="z4hagzo_29">Diagramme de notre architecture actuelle (en mode d&eacute;veloppement local) :</p><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="476px" preserveAspectRatio="none" style="width:718px;height:476px;background:#FFFFFF;" version="1.1" viewBox="0 0 718 476" width="718px" zoomAndPan="magnify"><defs/><g><!--cluster Votre Machine (Host)--><g id="cluster_Votre Machine (Host)"><polygon fill="#FFFFFF" points="21,80,31,70,447,70,447,449.03,437,459.03,21,459.03,21,80" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="437" x2="447" y1="80" y2="70"/><line style="stroke:#000000;stroke-width:1.0;" x1="21" x2="437" y1="80" y2="80"/><line style="stroke:#000000;stroke-width:1.0;" x1="437" x2="437" y1="80" y2="459.03"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="169" x="145.5" y="97.0752">Votre Machine (Host)</text></g><!--cluster EurekaContainer--><g id="cluster_EurekaContainer"><polygon fill="#FFFFFF" points="45,316.02,55,306.02,423,306.02,423,425.03,413,435.03,45,435.03,45,316.02" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="413" x2="423" y1="316.02" y2="306.02"/><line style="stroke:#000000;stroke-width:1.0;" x1="45" x2="413" y1="316.02" y2="316.02"/><line style="stroke:#000000;stroke-width:1.0;" x1="413" x2="413" y1="316.02" y2="435.03"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="302" x="79" y="333.0952">Conteneur Docker (my-eureka-server)</text></g><!--cluster IdeProcess--><g id="cluster_IdeProcess"><polygon fill="#FFFFFF" points="186,137,196,127,415,127,415,255.02,405,265.02,186,265.02,186,137" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="405" x2="415" y1="137" y2="127"/><line style="stroke:#000000;stroke-width:1.0;" x1="186" x2="405" y1="137" y2="137"/><line style="stroke:#000000;stroke-width:1.0;" x1="405" x2="405" y1="137" y2="265.02"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="83" x="255" y="154.0752">IDE (JVM)</text></g><!--entity p_host_eureka--><g id="elem_p_host_eureka"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="109" x="52.5" y="197.5"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="141.5" y="202.5"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="139.5" y="204.5"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="139.5" y="208.5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="69" x="67.5" y="231.5752">Port 8761</text></g><!--entity eureka-server.jar--><g id="elem_eureka-server.jar"><rect fill="#FFFFFF" height="40.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="150" x="61" y="375.52"/><polygon fill="#FFFFFF" points="194,380.52,194,394.52,206,394.52,206,386.52,200,380.52,194,380.52" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="200" x2="200" y1="380.52" y2="386.52"/><line style="stroke:#000000;stroke-width:1.0;" x1="206" x2="200" y1="386.52" y2="386.52"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="120" x="71" y="402.5952">eureka-server.jar</text></g><!--entity p_eureka--><g id="elem_p_eureka"><rect fill="#FFFFFF" height="47.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="109" x="245.5" y="372.02"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.0;" width="15" x="334.5" y="377.02"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="332.5" y="379.02"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.0;" width="4" x="332.5" y="383.02"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="69" x="260.5" y="406.0952">Port 8761</text></g><!--entity product-service.jar--><g id="elem_product-service.jar"><rect fill="#FFFFFF" height="40.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="162" x="210" y="201"/><polygon fill="#FFFFFF" points="355,206,355,220,367,220,367,212,361,206,355,206" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="361" x2="361" y1="206" y2="212"/><line style="stroke:#000000;stroke-width:1.0;" x1="367" x2="361" y1="212" y2="212"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="132" x="220" y="228.0752">product-service.jar</text></g><g id="elem_N1"><path d="M462.5,374.72 L462.5,416.3186 L711.5,416.3186 L711.5,384.72 L701.5,374.72 L462.5,374.72 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M701.5,374.72 L701.5,384.72 L711.5,384.72 L701.5,374.72 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="225" x="468.5" y="392.7898">Le service lanc&#233; depuis l'IDE peut</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="228" x="468.5" y="408.5891">joindre le conteneur via localhost.</text></g><!--link p_host_eureka to p_eureka--><g id="link_p_host_eureka_p_eureka"><path d="M138.57,244.9 C154.8,256.29 175.1,269.95 194,281.02 C208.58,289.55 215.04,287.17 228,298.02 C253.17,319.08 274.55,350.6 287.32,371.84 " fill="none" id="p_host_eureka-p_eureka" style="stroke:#000000;stroke-width:1.0;"/></g><!--link IdeProcess to p_host_eureka--><g id="link_IdeProcess_p_host_eureka"><path d="M415.0256,180.794 C415.0806,180.3574 415.1349,179.9185 415.1884,179.4774 C416.044,172.4204 416.6928,164.8109 416.9388,156.9362 C417.9225,125.4375 412.46,89.695 388,68.09 C323.38,11 268.53,24.74 194,68.09 C145.94,96.03 123.8287,155.7514 114.1387,191.2814 " fill="none" id="IdeProcess-to-p_host_eureka" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="112.56,197.07,118.7871,189.4396,113.8756,192.2462,111.069,187.3347,112.56,197.07" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102" x="233" y="35.0698">Enregistrement</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="178" x="195" y="50.8691">(via http://localhost:8761)</text></g><!--link IdeProcess to N1--><g id="link_IdeProcess_N1"><path d="M415.3427,230.0007 C415.5881,230.2358 415.8382,230.4756 416.0931,230.7199 C417.1128,231.6972 418.2086,232.7474 419.3753,233.8657 C421.7088,236.1022 424.3264,238.6109 427.1877,241.3533 C438.6328,252.3228 453.9781,267.0306 470.6462,283.0062 C503.9825,314.9575 542.61,351.98 565.91,374.31 " fill="none" id="IdeProcess-N1" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/></g><!--SRC=[XP71JiCm38RlUGhJ2zsXdNO1r0CNLeaXXdRQ2Gb5gQ7PqZXAqaa8xO5u3buCjuMjGvFmBTR___5dNyGQ6mHdfBR2KeMGh2bwXALKjRO8wJs5E4dWGm3NeBWZ6z5Yws5EQeiUqkOzuoTkPHRGxz2pGGOe-rQdvdIM3HbTIH_rgrGHaXDRlf4-EOWKDOuiMbQjo4UukRwQzRdkPN3rohtuHripmDXmqe4iEyQD41Vp4jA7zN80MLIuygGmXBCCpbFLgjX3Q8L7YhtO2p4oPxT_VY-Wj1xVTE2LDppziqrtMa8TeokcKqDAcavUT3WJmGUAFDiZmizFOAHLNvzGeMjr07FPZUsmvPmDQLln7GtoRdxFrMKVGlCUxMas7Z3FkV4D]--></g></svg></div></section><section class="chapter"><h2 id="exercice-6-comprendre-l-impact-d-un-arr-t" data-toc="exercice-6-comprendre-l-impact-d-un-arr-t">Exercice 6 : Comprendre l'impact d'un arr&ecirc;t</h2><p id="z4hagzo_102"><span class="control" id="z4hagzo_106">Contexte :</span> Votre <code class="code" id="z4hagzo_107">product-service</code> est bien enregistr&eacute; et visible dans le tableau de bord d'Eureka avec le statut <code class="code" id="z4hagzo_108">UP</code>.</p><p id="z4hagzo_103"><span class="control" id="z4hagzo_109">Votre mission :</span></p><ol class="list _decimal" id="z4hagzo_104" type="1"><li class="list__item" id="z4hagzo_110"><p id="z4hagzo_114">Arr&ecirc;tez proprement le <code class="code" id="z4hagzo_115">product-service</code> qui tourne dans votre IDE (en cliquant sur le bouton &quot;Stop&quot;). Observez les logs dans la console de l'IDE. Que se passe-t-il ?</p></li><li class="list__item" id="z4hagzo_111"><p id="z4hagzo_116">Rafra&icirc;chissez imm&eacute;diatement le tableau de bord d'Eureka. Le service a-t-il disparu ?</p></li><li class="list__item" id="z4hagzo_112"><p id="z4hagzo_117">Maintenant, relancez <code class="code" id="z4hagzo_118">product-service</code> depuis l'IDE, mais cette fois-ci, &quot;tuez&quot; le processus brutalement (par exemple, via le gestionnaire des t&acirc;ches de votre OS, ou en fermant le terminal si vous l'avez lanc&eacute; en ligne de commande) pour simuler une panne.</p></li><li class="list__item" id="z4hagzo_113"><p id="z4hagzo_119">Attendez 1 &agrave; 2 minutes, puis rafra&icirc;chissez le tableau de bord d'Eureka. Qu'observez-vous et pourquoi ?</p></li></ol><section class="chapter"><div class="collapse"><div class="collapse__title"><h3 id="correction-exercice-6" data-toc="correction-exercice-6">Correction exercice 6</h3></div><div class="collapse__content"><ol class="list _decimal" id="z4hagzo_120" type="1"><li class="list__item" id="z4hagzo_122"><p id="z4hagzo_126"><span class="control" id="z4hagzo_128">Arr&ecirc;t propre :</span> En arr&ecirc;tant proprement le service, vous verrez dans les logs une ligne indiquant qu'il envoie une requ&ecirc;te de &quot;d&eacute;senregistrement&quot; au serveur Eureka. Le client Eureka est poli : avant de s'&eacute;teindre, il pr&eacute;vient le serveur qu'il part.</p><div class="code-block" data-lang="none">
... unregistering from eureka ...
</div></li><li class="list__item" id="z4hagzo_123"><p id="z4hagzo_129"><span class="control" id="z4hagzo_130">Tableau de bord apr&egrave;s arr&ecirc;t propre :</span> Si vous rafra&icirc;chissez imm&eacute;diatement, le service aura disparu de la liste des instances. L'arr&ecirc;t propre a provoqu&eacute; son retrait instantan&eacute; de l'annuaire.</p></li><li class="list__item" id="z4hagzo_124"><p id="z4hagzo_131"><span class="control" id="z4hagzo_132">Simulation de panne :</span> En tuant le processus, le client Eureka n'a pas l'opportunit&eacute; d'envoyer sa requ&ecirc;te de d&eacute;senregistrement. Le serveur Eureka ne sait pas que le service est tomb&eacute;.</p></li><li class="list__item" id="z4hagzo_125"><p id="z4hagzo_133"><span class="control" id="z4hagzo_134">Tableau de bord apr&egrave;s la panne :</span> Si vous rafra&icirc;chissez le tableau de bord juste apr&egrave;s la panne, le service sera toujours list&eacute; comme <code class="code" id="z4hagzo_135">UP</code>. Le serveur Eureka attend toujours ses &quot;heartbeats&quot;. Ce n'est qu'apr&egrave;s l'expiration du bail (par d&eacute;faut 90 secondes sans recevoir de heartbeat) que le serveur Eureka va consid&eacute;rer le service comme mort. Il affichera alors un message d'avertissement en rouge en haut de la page (&quot;EMERGENCY! EUREKA MAY BE EXPERIENCING ISSUES...&quot;) et finira par retirer l'instance de la liste. Cela d&eacute;montre le m&eacute;canisme de r&eacute;silience bas&eacute; sur les heartbeats.</p></li></ol></div></div></section></section><section class="chapter"><h2 id="auto-valuation" data-toc="auto-valuation">Auto-&eacute;valuation</h2><p id="z4hagzo_136">Prenez un moment pour r&eacute;pondre &agrave; ces questions. Les corrections se trouvent &agrave; la toute fin du support de cours.</p><ol class="list _decimal" id="z4hagzo_137" type="1"><li class="list__item" id="z4hagzo_139"><p id="z4hagzo_144"><span class="control" id="z4hagzo_146">(QCM)</span> Quelle d&eacute;pendance Maven doit-on ajouter &agrave; un microservice pour qu'il puisse s'enregistrer aupr&egrave;s d'Eureka ?</p><ul class="list _bullet" id="z4hagzo_145"><li class="list__item" id="z4hagzo_147"><p id="z4hagzo_151">A) <code class="code" id="z4hagzo_152">spring-cloud-starter-netflix-eureka-server</code></p></li><li class="list__item" id="z4hagzo_148"><p id="z4hagzo_153">B) <code class="code" id="z4hagzo_154">spring-boot-starter-web</code></p></li><li class="list__item" id="z4hagzo_149"><p id="z4hagzo_155">C) <code class="code" id="z4hagzo_156">spring-cloud-starter</code></p></li><li class="list__item" id="z4hagzo_150"><p id="z4hagzo_157">D) <code class="code" id="z4hagzo_158">spring-cloud-starter-netflix-eureka-client</code></p></li></ul></li><li class="list__item" id="z4hagzo_140"><p id="z4hagzo_159"><span class="control" id="z4hagzo_160">(Question ouverte)</span> Dans <code class="code" id="z4hagzo_161">application.properties</code>, &agrave; quoi correspond la cl&eacute; <code class="code" id="z4hagzo_162">spring.application.name</code> dans le contexte d'Eureka ?</p></li><li class="list__item" id="z4hagzo_141"><p id="z4hagzo_163"><span class="control" id="z4hagzo_165">(QCM)</span> Quelle est la valeur de la propri&eacute;t&eacute; <code class="code" id="z4hagzo_166">eureka.client.serviceUrl.defaultZone</code> si mon serveur Eureka tourne en Docker sur le port 8761 de ma machine ?</p><ul class="list _bullet" id="z4hagzo_164"><li class="list__item" id="z4hagzo_167"><p id="z4hagzo_171">A) <code class="code" id="z4hagzo_172">http://eureka-server:8761/eureka</code></p></li><li class="list__item" id="z4hagzo_168"><p id="z4hagzo_173">B) <code class="code" id="z4hagzo_174">http://localhost:8761/eureka</code></p></li><li class="list__item" id="z4hagzo_169"><p id="z4hagzo_175">C) <code class="code" id="z4hagzo_176">http://localhost:8761</code></p></li><li class="list__item" id="z4hagzo_170"><p id="z4hagzo_177">D) <code class="code" id="z4hagzo_178">http://product-service:8081/eureka</code></p></li></ul></li><li class="list__item" id="z4hagzo_142"><p id="z4hagzo_179"><span class="control" id="z4hagzo_180">(Question ouverte)</span> Mon service ne s'enregistre pas aupr&egrave;s d'Eureka. Citez deux raisons probables &agrave; v&eacute;rifier en premier.</p></li><li class="list__item" id="z4hagzo_143"><p id="z4hagzo_181"><span class="control" id="z4hagzo_183">(QCM)</span> Par d&eacute;faut, &agrave; quelle fr&eacute;quence un client Eureka envoie-t-il un heartbeat au serveur ?</p><ul class="list _bullet" id="z4hagzo_182"><li class="list__item" id="z4hagzo_184"><p id="z4hagzo_188">A) Toutes les 5 secondes.</p></li><li class="list__item" id="z4hagzo_185"><p id="z4hagzo_189">B) Toutes les 30 secondes.</p></li><li class="list__item" id="z4hagzo_186"><p id="z4hagzo_190">C) Toutes les 90 secondes.</p></li><li class="list__item" id="z4hagzo_187"><p id="z4hagzo_191">D) Jamais, c'est le serveur qui contacte le client.</p></li></ul></li></ol></section><section class="chapter"><h2 id="conclusion" data-toc="conclusion">Conclusion</h2><p id="z4hagzo_192">F&eacute;licitations ! Vous avez r&eacute;ussi &agrave; connecter votre premier microservice &agrave; l'annuaire de d&eacute;couverte. Ce n'est plus une collection de services isol&eacute;s, mais le d&eacute;but d'un v&eacute;ritable &eacute;cosyst&egrave;me conscient de ses propres membres.</p><p id="z4hagzo_193">Vous avez transform&eacute; <code class="code" id="z4hagzo_195">product-service</code> en client Eureka avec une simple d&eacute;pendance et une ligne de configuration. Vous avez valid&eacute; son enregistrement et compris la diff&eacute;rence fondamentale entre un arr&ecirc;t propre et une panne gr&acirc;ce au m&eacute;canisme de heartbeat.</p><p id="z4hagzo_194">Maintenant que notre <code class="code" id="z4hagzo_196">product-service</code> est rep&eacute;rable par son nom, nous avons toutes les pi&egrave;ces du puzzle pour r&eacute;aliser notre objectif initial : faire communiquer deux services de mani&egrave;re dynamique. Dans le prochain TP, nous allons enfin cr&eacute;er le <code class="code" id="z4hagzo_197">order-service</code> et utiliser la puissance combin&eacute;e d' <span class="control" id="z4hagzo_198">Eureka</span> et d' <span class="control" id="z4hagzo_199">OpenFeign</span> pour qu'il puisse appeler le <code class="code" id="z4hagzo_200">product-service</code> sans jamais conna&icirc;tre son adresse IP. C'est l&agrave; que la magie va vraiment op&eacute;rer.</p></section><div class="last-modified">16 juillet 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="004-02-tp-2.html" class="navigation-links__prev">TP 2 : Construction du Phare - Mise en place du Serveur de D&eacute;couverte Eureka</a><a href="004-03-tp-4.html" class="navigation-links__next">TP 4 : Le Dialogue s'installe - Cr&eacute;ation et Communication avec un second service</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>